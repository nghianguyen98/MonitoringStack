/*! For license information please see module.js.LICENSE.txt */
define(["@emotion/css","@grafana/data","@grafana/runtime","@grafana/ui","app/core/core","lodash","moment","react","react-dom"],((e,t,n,r,o,a,s,i,l)=>(()=>{var c={42:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)&&n.length){var s=o.apply(null,n);s&&e.push(s)}else if("object"===a)for(var i in n)r.call(n,i)&&n[i]&&e.push(i)}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},8772:(e,t,n)=>{"use strict";var r=n(331);function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,a,s){if(s!==r){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:o};return n.PropTypes=n,n}},3615:(e,t,n)=>{e.exports=n(8772)()},331:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7644:t=>{"use strict";t.exports=e},3305:e=>{"use strict";e.exports=t},3545:e=>{"use strict";e.exports=n},7388:e=>{"use strict";e.exports=r},7294:e=>{"use strict";e.exports=o},5980:e=>{"use strict";e.exports=a},8283:e=>{"use strict";e.exports=s},2650:e=>{"use strict";e.exports=i},2729:e=>{"use strict";e.exports=l}},u={};function d(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={exports:{}};return c[e](n,n.exports,d),n.exports}d.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return d.d(t,{a:t}),t},d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var p={};return(()=>{"use strict";d.r(p),d.d(p,{plugin:()=>Kt});var e,t,n,r,o=d(3305),a=d(5980),s=d.n(a),i=d(8283),l=d.n(i);(r=e||(e={})).Group="group",r.Host="host",r.Application="application",r.Macro="macro",r.ItemTag="itemTag",r.Item="item",r.ItemValues="itemValues",(n=t||(t={})).Problems="problems",n.Recent="recent",n.History="history";class c extends o.BusEventWithPayload{}function u(e,t){const n=function(e){const t=[];let n=!1,r=!1;let o="";return s().forEach(e,(e=>{'"'===e&&r?o+=e:'"'===e&&n?n=!1:'"'!==e||n?"["!==e||n?"]"!==e||n?","!==e||n||r?o+=e:(t.push(o),o=""):r=!1:r=!0:n=!0})),t.push(o),t}(t.substring(t.indexOf("[")+1,t.lastIndexOf("]")));for(let t=n.length;t>=1;t--)e=e.replace("$"+t,n[t-1]);return e}function m(e,t){try{const n=function(e){const t=/(^[\d]+)(y|M|w|d|h|m|s)/g.exec(e);return l().duration(Number(t[1]),t[2]).valueOf()}(t);return Date.now()-1e3*e.timestamp<n}catch(e){return!1}}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}c.type="zbx-query-updated",(()=>{const e={},t=(0,o.getValueFormats)();for(const n of t)for(const t of n.submenu){const n=t.value;e[n]=n}})();var g=d(2650),f=d.n(g),v=d(3545),y=d(7294),b=d(7644),E=d(42),w=d.n(E),P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function C(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}const x={get:function(e,t,n){if(!t)return e;var r=N(t),o=void 0;try{o=r.reduce((function(e,t){return e[t]}),e)}catch(e){}return void 0!==o?o:n},set:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=N(t),o=void 0,a=e;(o=r.shift())&&r.length;)a[o]||(a[o]={}),a=a[o];return a[o]=n,e},takeRight:function(e,t){var n=t>e.length?0:e.length-t;return e.slice(n)},last:function(e){return e[e.length-1]},orderBy:function(e,t,n,r){return e.sort((function(e,o){for(var a=0;a<t.length;a+=1){var s=t[a],i=!1===n[a]||"desc"===n[a],l=s(e,o);if(l)return i?-l:l}return n[0]?e[r]-o[r]:o[r]-e[r]}))},range:function(e){for(var t=[],n=0;n<e;n+=1)t.push(e);return t},remove:function(e,t){return e.filter((function(n,r){return!!t(n)&&(e.splice(r,1),!0)}))},clone:function(e){try{return JSON.parse(JSON.stringify(e,(function(e,t){return"function"==typeof t?t.toString():t})))}catch(t){return e}},getFirstDefined:function(){for(var e=0;e<arguments.length;e+=1)if(void 0!==(arguments.length<=e?void 0:arguments[e]))return arguments.length<=e?void 0:arguments[e]},sum:function(e){return e.reduce((function(e,t){return e+t}),0)},makeTemplateComponent:function(e,t){if(!t)throw new Error("No displayName found for template component:",e);var n=function(t){var n=t.children,r=t.className,o=C(t,["children","className"]);return f().createElement("div",P({className:w()(e,r)},o),n)};return n.displayName=t,n},groupBy:function(e,t){return e.reduce((function(e,n,r){var o="function"==typeof t?t(n,r):n[t];return e[o]=S(e[o])?e[o]:[],e[o].push(n),e}),{})},isArray:S,splitProps:function(e){return{className:e.className,style:e.style,rest:C(e,["className","style"])||{}}},compactObject:function(e){var t={};return e&&Object.keys(e).map((function(n){return Object.prototype.hasOwnProperty.call(e,n)&&void 0!==e[n]&&void 0!==e[n]&&(t[n]=e[n]),!0})),t},isSortingDesc:function(e){return!("desc"!==e.sort&&!0!==e.desc&&!1!==e.asc)},normalizeComponent:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return T(e)?f().createElement(e,t):"function"==typeof e?e(t):n},asPx:function(e){return e=Number(e),Number.isNaN(e)?null:e+"px"}};function S(e){return Array.isArray(e)}function N(e){return k(e).join(".").replace(/\[/g,".").replace(/\]/g,"").split(".")}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(S(e))for(var n=0;n<e.length;n+=1)k(e[n],t);else t.push(e);return t}function T(e){return function(e){return"function"==typeof e&&!!Object.getPrototypeOf(e).isReactComponent}(e)||function(e){return"function"==typeof e&&String(e).includes(".createElement")}(e)}var O=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var D=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var B=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I=function(e){return f().createElement("button",_({type:"button"},e,{className:"-btn"}),e.children)},W=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getSafePage=n.getSafePage.bind(n),n.changePage=n.changePage.bind(n),n.applyPage=n.applyPage.bind(n),n.state={page:e.page},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),B(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.page!==e.page&&this.setState({page:e.page})}},{key:"getSafePage",value:function(e){return Number.isNaN(e)&&(e=this.props.page),Math.min(Math.max(e,0),this.props.pages-1)}},{key:"changePage",value:function(e){e=this.getSafePage(e),this.setState({page:e}),this.props.page!==e&&this.props.onPageChange(e)}},{key:"applyPage",value:function(e){e&&e.preventDefault();var t=this.state.page;this.changePage(""===t?this.props.page:t)}},{key:"getPageJumpProperties",value:function(){var e=this;return{onKeyPress:function(t){13!==t.which&&13!==t.keyCode||e.applyPage()},onBlur:this.applyPage,value:""===this.state.page?"":this.state.page+1,onChange:function(t){var n=t.target.value,r=n-1;if(""===n)return e.setState({page:n});e.setState({page:e.getSafePage(r)})},inputType:""===this.state.page?"text":"number",pageJumpText:this.props.pageJumpText}}},{key:"render",value:function(){var e=this,t=this.props,n=t.pages,r=t.page,o=t.showPageSizeOptions,a=t.pageSizeOptions,s=t.pageSize,i=t.showPageJump,l=t.canPrevious,c=t.canNext,u=t.onPageSizeChange,d=t.className,p=t.PreviousComponent,m=t.NextComponent,h=t.renderPageJump,g=t.renderCurrentPage,v=t.renderTotalPagesCount,y=t.renderPageSizeOptions;return f().createElement("div",{className:w()(d,"-pagination"),style:this.props.style},f().createElement("div",{className:"-previous"},f().createElement(p,{onClick:function(){l&&e.changePage(r-1)},disabled:!l},this.props.previousText)),f().createElement("div",{className:"-center"},f().createElement("span",{className:"-pageInfo"},this.props.pageText," ",i?h(this.getPageJumpProperties()):g(r)," ",this.props.ofText," ",v(n)),o&&y({pageSize:s,rowsSelectorText:this.props.rowsSelectorText,pageSizeOptions:a,onPageSizeChange:u,rowsText:this.props.rowsText})),f().createElement("div",{className:"-next"},f().createElement(m,{onClick:function(){c&&e.changePage(r+1)},disabled:!c},this.props.nextText)))}}]),t}(g.Component);W.defaultProps={PreviousComponent:I,NextComponent:I,renderPageJump:function(e){var t=e.onChange,n=e.value,r=e.onBlur,o=e.onKeyPress,a=e.inputType,s=e.pageJumpText;return f().createElement("div",{className:"-pageJump"},f().createElement("input",{"aria-label":s,type:a,onChange:t,value:n,onBlur:r,onKeyPress:o}))},renderCurrentPage:function(e){return f().createElement("span",{className:"-currentPage"},e+1)},renderTotalPagesCount:function(e){return f().createElement("span",{className:"-totalPages"},e||1)},renderPageSizeOptions:function(e){var t=e.pageSize,n=e.pageSizeOptions,r=e.rowsSelectorText,o=e.onPageSizeChange,a=e.rowsText;return f().createElement("span",{className:"select-wrap -pageSizeOptions"},f().createElement("select",{"aria-label":r,onChange:function(e){return o(Number(e.target.value))},value:t},n.map((function(e,t){return f().createElement("option",{key:t,value:e},e+" "+a)}))))}};const L=W;var K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function V(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var G=function(){return{}};const U={data:[],resolveData:function(e){return e},loading:!1,showPagination:!0,showPaginationTop:!1,showPaginationBottom:!0,showPageSizeOptions:!0,pageSizeOptions:[5,10,20,25,50,100],defaultPage:0,defaultPageSize:20,showPageJump:!0,collapseOnSortingChange:!0,collapseOnPageChange:!0,collapseOnDataChange:!0,freezeWhenExpanded:!1,sortable:!0,multiSort:!0,resizable:!0,filterable:!1,defaultSortDesc:!1,defaultSorted:[],defaultFiltered:[],defaultResized:[],defaultExpanded:{},defaultFilterMethod:function(e,t,n){var r=e.pivotId||e.id;return void 0===t[r]||String(t[r]).startsWith(e.value)},defaultSortMethod:function(e,t,n){return t=null==t?"":t,(e="string"==typeof(e=null==e?"":e)?e.toLowerCase():e)>(t="string"==typeof t?t.toLowerCase():t)?1:e<t?-1:0},onPageChange:void 0,onPageSizeChange:void 0,onSortedChange:void 0,onFilteredChange:void 0,onResizedChange:void 0,onExpandedChange:void 0,pivotBy:void 0,pivotValKey:"_pivotVal",pivotIDKey:"_pivotID",subRowsKey:"_subRows",aggregatedKey:"_aggregated",nestingLevelKey:"_nestingLevel",originalKey:"_original",indexKey:"_index",groupedByPivotKey:"_groupedByPivot",onFetchData:function(){return null},className:"",style:{},getProps:G,getTableProps:G,getTheadGroupProps:G,getTheadGroupTrProps:G,getTheadGroupThProps:G,getTheadProps:G,getTheadTrProps:G,getTheadThProps:G,getTheadFilterProps:G,getTheadFilterTrProps:G,getTheadFilterThProps:G,getTbodyProps:G,getTrGroupProps:G,getTrProps:G,getTdProps:G,getTfootProps:G,getTfootTrProps:G,getTfootTdProps:G,getPaginationProps:G,getLoadingProps:G,getNoDataProps:G,getResizerProps:G,column:{Cell:void 0,Header:void 0,Footer:void 0,Aggregated:void 0,Pivot:void 0,PivotValue:void 0,Expander:void 0,Filter:void 0,Placeholder:void 0,sortable:void 0,resizable:void 0,filterable:void 0,show:!0,minWidth:100,minResizeWidth:11,className:"",style:{},getProps:G,aggregate:void 0,headerClassName:"",headerStyle:{},getHeaderProps:G,footerClassName:"",footerStyle:{},getFooterProps:G,filterMethod:void 0,filterAll:!1,sortMethod:void 0},expanderDefaults:{sortable:!1,resizable:!1,filterable:!1,width:35},pivotDefaults:{},previousText:"Previous",nextText:"Next",loadingText:"Loading...",noDataText:"No rows found",pageText:"Page",ofText:"of",rowsText:"rows",pageJumpText:"jump to page",rowsSelectorText:"rows per page",TableComponent:function(e){var t=e.children,n=e.className,r=V(e,["children","className"]);return f().createElement("div",K({className:w()("rt-table",n),role:"grid"},r),t)},TheadComponent:x.makeTemplateComponent("rt-thead","Thead"),TbodyComponent:x.makeTemplateComponent("rt-tbody","Tbody"),TrGroupComponent:function(e){var t=e.children,n=e.className,r=V(e,["children","className"]);return f().createElement("div",K({className:w()("rt-tr-group",n),role:"rowgroup"},r),t)},TrComponent:function(e){var t=e.children,n=e.className,r=V(e,["children","className"]);return f().createElement("div",K({className:w()("rt-tr",n),role:"row"},r),t)},ThComponent:function(e){var t=e.toggleSort,n=e.className,r=e.children,o=V(e,["toggleSort","className","children"]);return f().createElement("div",K({className:w()("rt-th",n),onClick:function(e){return t&&t(e)},role:"columnheader",tabIndex:"-1"},o),r)},TdComponent:function(e){e.toggleSort;var t=e.className,n=e.children,r=V(e,["toggleSort","className","children"]);return f().createElement("div",K({className:w()("rt-td",t),role:"gridcell"},r),n)},TfootComponent:x.makeTemplateComponent("rt-tfoot","Tfoot"),FilterComponent:function(e){var t=e.filter,n=e.onChange,r=e.column;return f().createElement("input",{type:"text",style:{width:"100%"},placeholder:r.Placeholder,value:t?t.value:"",onChange:function(e){return n(e.target.value)}})},ExpanderComponent:function(e){var t=e.isExpanded;return f().createElement("div",{className:w()("rt-expander",t&&"-open")},"•")},PivotValueComponent:function(e){var t=e.subRows,n=e.value;return f().createElement("span",null,n," ",t&&"("+t.length+")")},AggregatedComponent:function(e){var t=e.subRows,n=e.column,r=t.filter((function(e){return void 0!==e[n.id]})).map((function(e,r){return f().createElement("span",{key:r},e[n.id],r<t.length-1?", ":"")}));return f().createElement("span",null,r)},PivotComponent:void 0,PaginationComponent:L,PreviousComponent:void 0,NextComponent:void 0,LoadingComponent:function(e){var t=e.className,n=e.loading,r=e.loadingText,o=V(e,["className","loading","loadingText"]);return f().createElement("div",K({className:w()("-loading",{"-active":n},t)},o),f().createElement("div",{className:"-loading-inner"},r))},NoDataComponent:x.makeTemplateComponent("rt-noData","NoData"),ResizerComponent:x.makeTemplateComponent("rt-resizer","Resizer"),PadRowComponent:function(){return f().createElement("span",null," ")}};var q=d(3615),J=d.n(q);const Y={data:J().any,loading:J().bool,showPagination:J().bool,showPaginationTop:J().bool,showPaginationBottom:J().bool,showPageSizeOptions:J().bool,pageSizeOptions:J().array,defaultPageSize:J().number,showPageJump:J().bool,collapseOnSortingChange:J().bool,collapseOnPageChange:J().bool,collapseOnDataChange:J().bool,freezeWhenExpanded:J().bool,sortable:J().bool,resizable:J().bool,filterable:J().bool,defaultSortDesc:J().bool,defaultSorted:J().array,defaultFiltered:J().array,defaultResized:J().array,defaultExpanded:J().object,defaultFilterMethod:J().func,defaultSortMethod:J().func,onPageChange:J().func,onPageSizeChange:J().func,onSortedChange:J().func,onFilteredChange:J().func,onResizedChange:J().func,onExpandedChange:J().func,pivotBy:J().array,pivotValKey:J().string,pivotIDKey:J().string,subRowsKey:J().string,aggregatedKey:J().string,nestingLevelKey:J().string,originalKey:J().string,indexKey:J().string,groupedByPivotKey:J().string,onFetchData:J().func,className:J().string,style:J().object,getProps:J().func,getTableProps:J().func,getTheadGroupProps:J().func,getTheadGroupTrProps:J().func,getTheadGroupThProps:J().func,getTheadProps:J().func,getTheadTrProps:J().func,getTheadThProps:J().func,getTheadFilterProps:J().func,getTheadFilterTrProps:J().func,getTheadFilterThProps:J().func,getTbodyProps:J().func,getTrGroupProps:J().func,getTrProps:J().func,getTdProps:J().func,getTfootProps:J().func,getTfootTrProps:J().func,getTfootTdProps:J().func,getPaginationProps:J().func,getLoadingProps:J().func,getNoDataProps:J().func,getResizerProps:J().func,columns:J().arrayOf(J().shape({Cell:J().oneOfType([J().element,J().string,J().func]),Header:J().oneOfType([J().element,J().string,J().func]),Footer:J().oneOfType([J().element,J().string,J().func]),Aggregated:J().oneOfType([J().element,J().string,J().func]),Pivot:J().oneOfType([J().element,J().string,J().func]),PivotValue:J().oneOfType([J().element,J().string,J().func]),Expander:J().oneOfType([J().element,J().string,J().func]),Filter:J().oneOfType([J().element,J().func]),sortable:J().bool,resizable:J().bool,filterable:J().bool,show:J().bool,minWidth:J().number,minResizeWidth:J().number,className:J().string,style:J().object,getProps:J().func,aggregate:J().func,headerClassName:J().string,headerStyle:J().object,getHeaderProps:J().func,footerClassName:J().string,footerStyle:J().object,getFooterProps:J().func,filterMethod:J().func,filterAll:J().bool,sortMethod:J().func})),expanderDefaults:J().shape({sortable:J().bool,resizable:J().bool,filterable:J().bool,width:J().number}),pivotDefaults:J().object,previousText:J().node,nextText:J().node,loadingText:J().node,noDataText:J().node,pageText:J().node,ofText:J().node,rowsText:J().node,pageJumpText:J().node,rowsSelectorText:J().node,TableComponent:J().elementType,TheadComponent:J().elementType,TbodyComponent:J().elementType,TrGroupComponent:J().elementType,TrComponent:J().elementType,ThComponent:J().elementType,TdComponent:J().elementType,TfootComponent:J().elementType,FilterComponent:J().elementType,ExpanderComponent:J().elementType,PivotValueComponent:J().elementType,AggregatedComponent:J().elementType,PivotComponent:J().elementType,PaginationComponent:J().elementType,PreviousComponent:J().elementType,NextComponent:J().elementType,LoadingComponent:J().elementType,NoDataComponent:J().elementType,ResizerComponent:J().elementType,PadRowComponent:J().elementType};var X,Q=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ee=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),te=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.getResolvedState=n.getResolvedState.bind(n),n.getDataModel=n.getDataModel.bind(n),n.getSortedData=n.getSortedData.bind(n),n.fireFetchData=n.fireFetchData.bind(n),n.getPropOrState=n.getPropOrState.bind(n),n.getStateOrProp=n.getStateOrProp.bind(n),n.filterData=n.filterData.bind(n),n.sortData=n.sortData.bind(n),n.getMinRows=n.getMinRows.bind(n),n.onPageChange=n.onPageChange.bind(n),n.onPageSizeChange=n.onPageSizeChange.bind(n),n.sortColumn=n.sortColumn.bind(n),n.filterColumn=n.filterColumn.bind(n),n.resizeColumnStart=n.resizeColumnStart.bind(n),n.resizeColumnEnd=n.resizeColumnEnd.bind(n),n.resizeColumnMoving=n.resizeColumnMoving.bind(n),n.state={page:e.defaultPage,pageSize:e.defaultPageSize,sorted:e.defaultSorted,expanded:e.defaultExpanded,filtered:e.defaultFiltered,resized:e.defaultResized,currentlyResizing:!1,skipNextSort:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),ee(t,[{key:"render",value:function(){var e=this,t=this.getResolvedState(),n=t.children,r=t.className,o=t.style,a=t.getProps,s=t.getTableProps,i=t.getTheadGroupProps,l=t.getTheadGroupTrProps,c=t.getTheadGroupThProps,u=t.getTheadProps,d=t.getTheadTrProps,p=t.getTheadThProps,m=t.getTheadFilterProps,h=t.getTheadFilterTrProps,g=t.getTheadFilterThProps,v=t.getTbodyProps,y=t.getTrGroupProps,b=t.getTrProps,E=t.getTdProps,P=t.getTfootProps,C=t.getTfootTrProps,S=t.getTfootTdProps,N=t.getPaginationProps,k=t.getLoadingProps,T=t.getNoDataProps,O=t.getResizerProps,z=t.showPagination,F=t.showPaginationTop,D=t.showPaginationBottom,R=t.manual,M=t.loadingText,H=t.noDataText,j=t.sortable,A=t.multiSort,$=t.resizable,B=t.filterable,_=t.pivotIDKey,I=t.pivotValKey,W=t.pivotBy,L=t.subRowsKey,K=t.aggregatedKey,V=t.originalKey,G=t.indexKey,q=t.groupedByPivotKey,J=t.loading,Y=t.pageSize,X=t.page,ee=t.sorted,te=t.filtered,ne=t.resized,re=t.expanded,oe=t.pages,ae=t.onExpandedChange,se=t.TableComponent,ie=t.TheadComponent,le=t.TbodyComponent,ce=t.TrGroupComponent,ue=t.TrComponent,de=t.ThComponent,pe=t.TdComponent,me=t.TfootComponent,he=t.PaginationComponent,ge=t.LoadingComponent,fe=t.SubComponent,ve=t.NoDataComponent,ye=t.ResizerComponent,be=t.ExpanderComponent,Ee=t.PivotValueComponent,we=t.PivotComponent,Pe=t.AggregatedComponent,Ce=t.FilterComponent,xe=t.PadRowComponent,Se=t.resolvedData,Ne=t.allVisibleColumns,ke=t.headerGroups,Te=t.hasHeaderGroups,Oe=t.sortedData,ze=t.currentlyResizing,Fe=Y*X,De=Fe+Y,Re=R?Se:Oe.slice(Fe,De),Me=this.getMinRows(),He=x.range(Math.max(Me-Re.length,0)),je=Ne.some((function(e){return e.Footer})),Ae=B||Ne.some((function(e){return e.filterable})),$e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return[t.map((function(t,o){var a=Z({},t,{_viewIndex:r+=1}),s=n.concat([o]);if(a[L]&&x.get(re,s)){var i=e(a[L],s,r),l=Q(i,2);a[L]=l[0],r=l[1]}return a})),r]}(Re),Be=Q($e,1);Re=Be[0];var _e=X>0,Ie=X+1<oe,We=x.sum(Ne.map((function(e){var t=ne.find((function(t){return t.id===e.id}))||{};return x.getFirstDefined(t.value,e.width,e.minWidth)}))),Le=-1,Ke=Z({},t,{startRow:Fe,endRow:De,pageRows:Re,minRows:Me,padRows:He,hasColumnFooter:je,canPrevious:_e,canNext:Ie,rowMinWidth:We}),Ve=x.splitProps(a(Ke,void 0,void 0,this)),Ge=x.splitProps(s(Ke,void 0,void 0,this)),Ue=x.splitProps(v(Ke,void 0,void 0,this)),qe=k(Ke,void 0,void 0,this),Je=T(Ke,void 0,void 0,this),Ye=function(t,n){var r=function(e){return(ne.find((function(t){return t.id===e.id}))||{}).value},o=x.sum(t.columns.map((function(e){return e.width||r(e)?0:e.minWidth}))),a=x.sum(t.columns.map((function(e){return x.getFirstDefined(r(e),e.width,e.minWidth)}))),s=x.sum(t.columns.map((function(e){return x.getFirstDefined(r(e),e.width,e.maxWidth)}))),i=x.splitProps(c(Ke,void 0,t,e)),l=x.splitProps(t.getHeaderProps(Ke,void 0,t,e)),u=[t.headerClassName,i.className,l.className],d=Z({},t.headerStyle,i.style,l.style),p=Z({},i.rest,l.rest),m={flex:o+" 0 auto",width:x.asPx(a),maxWidth:x.asPx(s)};return f().createElement(de,Z({key:n+"-"+t.id,className:w()(u),style:Z({},d,m)},p),x.normalizeComponent(t.Header,{data:Oe,column:t}))},Xe=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o=ee.find((function(e){return e.id===t.id})),a="function"==typeof t.show?t.show():t.show,s=x.getFirstDefined(r.value,t.width,t.minWidth),i=x.getFirstDefined(r.value,t.width,t.maxWidth),l=x.splitProps(p(Ke,void 0,t,e)),c=x.splitProps(t.getHeaderProps(Ke,void 0,t,e)),u=[t.headerClassName,l.className,c.className],d=Z({},t.headerStyle,l.style,c.style),m=Z({},l.rest,c.rest),h=x.getFirstDefined(t.resizable,$,!1),g=h?f().createElement(ye,Z({onMouseDown:function(n){return e.resizeColumnStart(n,t,!1)},onTouchStart:function(n){return e.resizeColumnStart(n,t,!0)}},O("finalState",void 0,t,e))):null,v=x.getFirstDefined(t.sortable,j,!1);return f().createElement(de,Z({key:n+"-"+t.id,className:w()(u,h&&"rt-resizable-header",o?o.desc?"-sort-desc":"-sort-asc":"",v&&"-cursor-pointer",!a&&"-hidden",W&&W.slice(0,-1).includes(t.id)&&"rt-header-pivot"),style:Z({},d,{flex:s+" 0 auto",width:x.asPx(s),maxWidth:x.asPx(i)}),toggleSort:function(n){v&&e.sortColumn(t,!!A&&n.shiftKey)}},m),f().createElement("div",{className:w()(h&&"rt-resizable-header-content")},x.normalizeComponent(t.Header,{data:Oe,column:t})),g)},Qe=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o=x.getFirstDefined(r.value,t.width,t.minWidth),a=x.getFirstDefined(r.value,t.width,t.maxWidth),s=x.splitProps(g(Ke,void 0,t,e)),i=x.splitProps(t.getHeaderProps(Ke,void 0,t,e)),l=[t.headerClassName,s.className,i.className],c=Z({},t.headerStyle,s.style,i.style),u=Z({},s.rest,i.rest),d=te.find((function(e){return e.id===t.id})),p=t.Filter||Ce,m=x.getFirstDefined(t.filterable,B,!1);return f().createElement(de,Z({key:n+"-"+t.id,className:w()(l),style:Z({},c,{flex:o+" 0 auto",width:x.asPx(o),maxWidth:x.asPx(a)})},u),m?x.normalizeComponent(p,{column:t,filter:d,onChange:function(n){return e.filterColumn(t,n)}},U.column.Filter):null)},Ze=function t(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a={original:n[V],row:n,index:n[G],viewIndex:Le+=1,pageSize:Y,page:X,level:o.length,nestingPath:o.concat([r]),aggregated:n[K],groupedByPivot:n[q],subRows:n[L]},s=x.get(re,a.nestingPath),i=y(Ke,a,void 0,e),l=x.splitProps(b(Ke,a,void 0,e));return f().createElement(ce,Z({key:a.nestingPath.join("_")},i),f().createElement(ue,Z({className:w()(l.className,n._viewIndex%2?"-even":"-odd"),style:l.style},l.rest),Ne.map((function(t,r){var o=ne.find((function(e){return e.id===t.id}))||{},i="function"==typeof t.show?t.show():t.show,l=x.getFirstDefined(o.value,t.width,t.minWidth),c=x.getFirstDefined(o.value,t.width,t.maxWidth),u=x.splitProps(E(Ke,a,t,e)),d=x.splitProps(t.getProps(Ke,a,t,e)),p=[u.className,t.className,d.className],m=Z({},u.style,t.style,d.style),h=Z({},a,{isExpanded:s,column:Z({},t),value:a.row[t.id],pivoted:t.pivoted,expander:t.expander,resized:ne,show:i,width:l,maxWidth:c,tdProps:u,columnProps:d,classes:p,styles:m}),g=h.value,v=void 0,y=void 0,b=void 0,P=x.normalizeComponent(t.Cell,h,g),C=t.Aggregated||(t.aggregate?t.Cell:Pe),S=t.Expander||be,N=t.PivotValue||Ee,k=we||function(e){return f().createElement("div",null,f().createElement(S,e),f().createElement(N,e))},T=t.Pivot||k;(h.pivoted||h.expander)&&(h.expandable=!0,v=!0,!h.pivoted||h.subRows||fe||(h.expandable=!1)),h.pivoted?(y=a.row[_]===t.id&&h.subRows,b=W.indexOf(t.id)>W.indexOf(a.row[_])&&h.subRows,P=y?x.normalizeComponent(T,Z({},h,{value:n[I]}),n[I]):b?x.normalizeComponent(C,h,g):null):h.aggregated&&(P=x.normalizeComponent(C,h,g)),h.expander&&(P=x.normalizeComponent(S,h,n[I]),W&&(h.groupedByPivot&&(P=null),h.subRows||fe||(P=null)));var O=v?function(t){var n=x.clone(re);return n=s?x.set(n,h.nestingPath,!1):x.set(n,h.nestingPath,{}),e.setStateWithData({expanded:n},(function(){return ae&&ae(n,h.nestingPath,t,h)}))}:function(){},z={onClick:O};return u.rest.onClick&&(z.onClick=function(e){u.rest.onClick(e,(function(){return O(e)}))}),d.rest.onClick&&(z.onClick=function(e){d.rest.onClick(e,(function(){return O(e)}))}),f().createElement(pe,Z({key:r+"-"+t.id,className:w()(p,!h.expandable&&!i&&"hidden",h.expandable&&"rt-expandable",(y||b)&&"rt-pivot"),style:Z({},m,{flex:l+" 0 auto",width:x.asPx(l),maxWidth:x.asPx(c)})},u.rest,d.rest,z),P)}))),a.subRows&&s&&a.subRows.map((function(e,n){return t(e,n,a.nestingPath)})),fe&&!a.subRows&&s&&fe(a,(function(){var e=x.clone(re);x.set(e,a.nestingPath,!1)})))},et=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o="function"==typeof t.show?t.show():t.show,a=x.getFirstDefined(r.value,t.width,t.minWidth),s=a,i=x.getFirstDefined(r.value,t.width,t.maxWidth),l=x.splitProps(E(Ke,void 0,t,e)),c=x.splitProps(t.getProps(Ke,void 0,t,e)),u=[l.className,t.className,c.className],d=Z({},l.style,t.style,c.style);return f().createElement(pe,Z({key:n+"-"+t.id,className:w()(u,!o&&"hidden"),style:Z({},d,{flex:s+" 0 auto",width:x.asPx(a),maxWidth:x.asPx(i)})},l.rest),x.normalizeComponent(xe))},tt=function(t,n){var r=y(Ke,void 0,void 0,e),o=x.splitProps(b(Ke,void 0,void 0,e));return f().createElement(ce,Z({key:"pad-"+n},r),f().createElement(ue,{className:w()("-padRow",(Re.length+n)%2?"-even":"-odd",o.className),style:o.style||{}},Ne.map(et)))},nt=function(t,n){var r=ne.find((function(e){return e.id===t.id}))||{},o="function"==typeof t.show?t.show():t.show,a=x.getFirstDefined(r.value,t.width,t.minWidth),s=x.getFirstDefined(r.value,t.width,t.maxWidth),i=x.splitProps(S(Ke,void 0,t,e)),l=x.splitProps(t.getProps(Ke,void 0,t,e)),c=x.splitProps(t.getFooterProps(Ke,void 0,t,e)),u=[i.className,t.className,l.className,c.className],d=Z({},i.style,t.style,l.style,c.style);return f().createElement(pe,Z({key:n+"-"+t.id,className:w()(u,!o&&"hidden"),style:Z({},d,{flex:a+" 0 auto",width:x.asPx(a),maxWidth:x.asPx(s)})},l.rest,i.rest,c.rest),x.normalizeComponent(t.Footer,{data:Oe,column:t}))},rt=function(n){var r=x.splitProps(N(Ke,void 0,void 0,e));return f().createElement(he,Z({},t,{pages:oe,canPrevious:_e,canNext:Ie,onPageChange:e.onPageChange,onPageSizeChange:e.onPageSizeChange,className:r.className,style:r.style,isTop:n},r.rest))},ot=function(){return f().createElement("div",Z({className:w()("ReactTable",r,Ve.className),style:Z({},o,Ve.style)},Ve.rest),z&&F?f().createElement("div",{className:"pagination-top"},rt(!0)):null,f().createElement(se,Z({className:w()(Ge.className,ze?"rt-resizing":""),style:Ge.style},Ge.rest),Te?(g=x.splitProps(i(Ke,void 0,void 0,e)),v=x.splitProps(l(Ke,void 0,void 0,e)),f().createElement(ie,Z({className:w()("-headerGroups",g.className),style:Z({},g.style,{minWidth:We+"px"})},g.rest),f().createElement(ue,Z({className:v.className,style:v.style},v.rest),ke.map(Ye)))):null,(c=x.splitProps(u(Ke,void 0,void 0,e)),p=x.splitProps(d(Ke,void 0,void 0,e)),f().createElement(ie,Z({className:w()("-header",c.className),style:Z({},c.style,{minWidth:We+"px"})},c.rest),f().createElement(ue,Z({className:p.className,style:p.style},p.rest),Ne.map(Xe)))),Ae?(a=x.splitProps(m(Ke,void 0,void 0,e)),s=x.splitProps(h(Ke,void 0,void 0,e)),f().createElement(ie,Z({className:w()("-filters",a.className),style:Z({},a.style,{minWidth:We+"px"})},a.rest),f().createElement(ue,Z({className:s.className,style:s.style},s.rest),Ne.map(Qe)))):null,f().createElement(le,Z({className:w()(Ue.className),style:Z({},Ue.style,{minWidth:We+"px"})},Ue.rest),Re.map((function(e,t){return Ze(e,t)})),He.map(tt)),je?(t=x.splitProps(P(Ke,void 0,void 0,e)),n=x.splitProps(C(Ke,void 0,void 0,e)),f().createElement(me,Z({className:t.className,style:Z({},t.style,{minWidth:We+"px"})},t.rest),f().createElement(ue,Z({className:w()(n.className),style:n.style},n.rest),Ne.map(nt)))):null),z&&D?f().createElement("div",{className:"pagination-bottom"},rt(!1)):null,!Re.length&&f().createElement(ve,Je,x.normalizeComponent(H)),f().createElement(ge,Z({loading:J,loadingText:M},qe)));var t,n,a,s,c,p,g,v};return n?n(Ke,ot,this):ot()}}]),t}((X=function(e){function t(){return z(this,t),F(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),O(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setStateWithData(this.getDataModel(this.getResolvedState(),!0))}},{key:"componentDidMount",value:function(){this.fireFetchData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e,t){var n=this.getResolvedState(),r=this.getResolvedState(e,t);["sorted","filtered","resized","expanded"].forEach((function(e){var t="default"+(e.charAt(0).toUpperCase()+e.slice(1));JSON.stringify(n[t])!==JSON.stringify(r[t])&&(r[e]=r[t])})),["sortable","filterable","resizable"].forEach((function(e){if(n[e]!==r[e]){var t=e.replace("able","")+"ed",o="default"+(t.charAt(0).toUpperCase()+t.slice(1));r[t]=r[o]}})),n.data===r.data&&n.columns===r.columns&&n.pivotBy===r.pivotBy&&n.sorted===r.sorted&&n.filtered===r.filtered||this.setStateWithData(this.getDataModel(r,n.data!==r.data))}},{key:"setStateWithData",value:function(e,t){var n=this,r=this.getResolvedState(),o=this.getResolvedState({},e),a=o.freezeWhenExpanded;if(o.frozen=!1,a)for(var s=Object.keys(o.expanded),i=0;i<s.length;i+=1)if(o.expanded[s[i]]){o.frozen=!0;break}return(r.frozen&&!o.frozen||r.sorted!==o.sorted||r.filtered!==o.filtered||r.showFilters!==o.showFilters||!o.frozen&&r.resolvedData!==o.resolvedData)&&((r.sorted!==o.sorted&&this.props.collapseOnSortingChange||r.filtered!==o.filtered||r.showFilters!==o.showFilters||r.sortedData&&!o.frozen&&r.resolvedData!==o.resolvedData&&this.props.collapseOnDataChange)&&(o.expanded={}),Object.assign(o,this.getSortedData(o))),r.filtered!==o.filtered&&(o.page=0),o.sortedData&&(o.pages=o.manual?o.pages:Math.ceil(o.sortedData.length/o.pageSize),o.page=o.manual?o.page:Math.max(o.page>=o.pages?o.pages-1:o.page,0)),this.setState(o,(function(){t&&t(),r.page===o.page&&r.pageSize===o.pageSize&&r.sorted===o.sorted&&r.filtered===o.filtered||n.fireFetchData()}))}}]),t}(g.Component),function(e){function t(){return A(this,t),$(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),M(t,[{key:"getResolvedState",value:function(e,t){return R({},x.compactObject(this.state),x.compactObject(this.props),x.compactObject(t),x.compactObject(e))}},{key:"getDataModel",value:function(e,t){var n=this,r=e.columns,o=e.pivotBy,a=void 0===o?[]:o,s=e.data,i=e.resolveData,l=e.pivotIDKey,c=e.pivotValKey,u=e.subRowsKey,d=e.aggregatedKey,p=e.nestingLevelKey,m=e.originalKey,h=e.indexKey,g=e.groupedByPivotKey,v=e.SubComponent,y=!1;r.forEach((function(e){e.columns&&(y=!0)}));var b=[].concat(j(r)),E=r.find((function(e){return e.expander||e.columns&&e.columns.some((function(e){return e.expander}))}));E&&!E.expander&&(E=E.columns.find((function(e){return e.expander}))),v&&!E&&(b=[E={expander:!0}].concat(j(b)));var w=[],P=function(e,t){var r=function(e,t){var r=void 0;if((r=e.expander?R({},n.props.column,n.props.expanderDefaults,e):R({},n.props.column,e)).maxWidth<r.minWidth&&(r.minWidth=r.maxWidth),t&&(r.parentColumn=t),"string"==typeof r.accessor){r.id=r.id||r.accessor;var o=r.accessor;return r.accessor=function(e){return x.get(e,o)},r}if(r.accessor&&!r.id)throw console.warn(r),new Error("A column id is required if using a non-string accessor for column above.");return r.accessor||(r.accessor=function(){}),r}(e,t);return w.push(r),r},C=b.map((function(e){return e.columns?R({},e,{columns:e.columns.map((function(t){return P(t,e)}))}):P(e)})).slice(),S=[],N=(C=(C=C.map((function(e){if(e.columns){var t=e.columns.filter((function(e){return!(a.indexOf(e.id)>-1)&&x.getFirstDefined(e.show,!0)}));return R({},e,{columns:t})}return e}))).filter((function(e){return e.columns?e.columns.length:!(a.indexOf(e.id)>-1)&&x.getFirstDefined(e.show,!0)}))).findIndex((function(e){return e.pivot}));if(a.length){var k=[];a.forEach((function(e){var t=w.find((function(t){return t.id===e}));t&&k.push(t)}));var T=k.reduce((function(e,t){return e&&e===t.parentColumn&&t.parentColumn}),k[0].parentColumn),O=y&&T.Header,z={Header:O=O||function(){return f().createElement("strong",null,"Pivoted")},columns:k.map((function(e){return R({},n.props.pivotDefaults,e,{pivoted:!0})}))};N>=0?(z=R({},C[N],z),C.splice(N,1,z)):C.unshift(z)}var F=[],M=[],A=function(e,t){F.push(R({},n.props.column,t,{columns:e})),M=[]};C.forEach((function(e){if(e.columns)return S=S.concat(e.columns),M.length>0&&A(M),void A(e.columns,e);S.push(e),M.push(e)})),y&&M.length>0&&A(M);var $=function e(t,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=(H(r={},m,t),H(r,h,n),H(r,u,t[u]),H(r,p,o),r);return w.forEach((function(e){e.expander||(a[e.id]=e.accessor(t))})),a[u]&&(a[u]=a[u].map((function(t,n){return e(t,n,o+1)}))),a},B=this.resolvedData;this.resolvedData&&!t||(B=i(s),this.resolvedData=B),B=B.map((function(e,t){return $(e,t)}));var _=S.filter((function(e){return!e.expander&&e.aggregate})),I=function(e){var t={};return _.forEach((function(n){var r=e.map((function(e){return e[n.id]}));t[n.id]=n.aggregate(r,e)})),t};return a.length&&(B=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r===n.length)return t;var o=Object.entries(x.groupBy(t,n[r])).map((function(e){var t,o=D(e,2),a=o[0],s=o[1];return H(t={},l,n[r]),H(t,c,a),H(t,n[r],a),H(t,u,s),H(t,p,r),H(t,g,!0),t}));return o.map((function(t){var o,a=e(t[u],n,r+1);return R({},t,(H(o={},u,a),H(o,d,!0),o),I(a))}))}(B,a)),R({},e,{resolvedData:B,allVisibleColumns:S,headerGroups:F,allDecoratedColumns:w,hasHeaderGroups:y})}},{key:"getSortedData",value:function(e){var t=e.manual,n=e.sorted,r=e.filtered,o=e.defaultFilterMethod,a=e.resolvedData,s=e.allDecoratedColumns,i={};return s.filter((function(e){return e.sortMethod})).forEach((function(e){i[e.id]=e.sortMethod})),{sortedData:t?a:this.sortData(this.filterData(a,r,o,s),n,i)}}},{key:"fireFetchData",value:function(){var e=R({},this.getResolvedState(),{page:this.getStateOrProp("page"),pageSize:this.getStateOrProp("pageSize"),filtered:this.getStateOrProp("filtered")});this.props.onFetchData(e,this)}},{key:"getPropOrState",value:function(e){return x.getFirstDefined(this.props[e],this.state[e])}},{key:"getStateOrProp",value:function(e){return x.getFirstDefined(this.state[e],this.props[e])}},{key:"filterData",value:function(e,t,n,r){var o=this,a=e;return t.length&&(a=(a=t.reduce((function(e,t){var o=r.find((function(e){return e.id===t.id}));if(!o||!1===o.filterable)return e;var a=o.filterMethod||n;return o.filterAll?a(t,e,o):e.filter((function(e){return a(t,e,o)}))}),a)).map((function(e){return e[o.props.subRowsKey]?R({},e,H({},o.props.subRowsKey,o.filterData(e[o.props.subRowsKey],t,n,r))):e})).filter((function(e){return!e[o.props.subRowsKey]||e[o.props.subRowsKey].length>0}))),a}},{key:"sortData",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.length)return e;var o=(this.props.orderByMethod||x.orderBy)(e,t.map((function(e){return r[e.id]?function(t,n){return r[e.id](t[e.id],n[e.id],e.desc)}:function(t,r){return n.props.defaultSortMethod(t[e.id],r[e.id],e.desc)}})),t.map((function(e){return!e.desc})),this.props.indexKey);return o.forEach((function(e){e[n.props.subRowsKey]&&(e[n.props.subRowsKey]=n.sortData(e[n.props.subRowsKey],t,r))})),o}},{key:"getMinRows",value:function(){return x.getFirstDefined(this.props.minRows,this.getStateOrProp("pageSize"))}},{key:"onPageChange",value:function(e){var t=this.props,n=t.onPageChange,r=t.collapseOnPageChange,o={page:e};r&&(o.expanded={}),this.setStateWithData(o,(function(){return n&&n(e)}))}},{key:"onPageSizeChange",value:function(e){var t=this.props.onPageSizeChange,n=this.getResolvedState(),r=n.pageSize*n.page,o=Math.floor(r/e);this.setStateWithData({pageSize:e,page:o},(function(){return t&&t(e,o)}))}},{key:"sortColumn",value:function(e,t){var n=this.getResolvedState(),r=n.sorted,o=n.skipNextSort,a=n.defaultSortDesc,s=Object.prototype.hasOwnProperty.call(e,"defaultSortDesc")?e.defaultSortDesc:a,i=!s;if(o)this.setStateWithData({skipNextSort:!1});else{var l=this.props.onSortedChange,c=x.clone(r||[]).map((function(e){return e.desc=x.isSortingDesc(e),e}));if(x.isArray(e)){var u=c.findIndex((function(t){return t.id===e[0].id}));u>-1?(c[u].desc===i?t?c.splice(u,e.length):e.forEach((function(e,t){c[u+t].desc=s})):e.forEach((function(e,t){c[u+t].desc=i})),t||(c=c.slice(u,e.length))):c=t?c.concat(e.map((function(e){return{id:e.id,desc:s}}))):e.map((function(e){return{id:e.id,desc:s}}))}else{var d=c.findIndex((function(t){return t.id===e.id}));if(d>-1){var p=c[d];p.desc===i?t?c.splice(d,1):(p.desc=s,c=[p]):(p.desc=i,t||(c=[p]))}else t?c.push({id:e.id,desc:s}):c=[{id:e.id,desc:s}]}this.setStateWithData({page:!r.length&&c.length||!t?0:this.state.page,sorted:c},(function(){return l&&l(c,e,t)}))}}},{key:"filterColumn",value:function(e,t){var n=this.getResolvedState().filtered,r=this.props.onFilteredChange,o=(n||[]).filter((function(t){return t.id!==e.id}));""!==t&&o.push({id:e.id,value:t}),this.setStateWithData({filtered:o},(function(){return r&&r(o,e,t)}))}},{key:"resizeColumnStart",value:function(e,t,n){var r=this;e.stopPropagation();var o,a=e.target.parentElement.getBoundingClientRect().width;o=n?e.changedTouches[0].pageX:e.pageX,this.trapEvents=!0,this.setStateWithData({currentlyResizing:{id:t.id,startX:o,parentWidth:a}},(function(){n?(document.addEventListener("touchmove",r.resizeColumnMoving),document.addEventListener("touchcancel",r.resizeColumnEnd),document.addEventListener("touchend",r.resizeColumnEnd)):(document.addEventListener("mousemove",r.resizeColumnMoving),document.addEventListener("mouseup",r.resizeColumnEnd),document.addEventListener("mouseleave",r.resizeColumnEnd))}))}},{key:"resizeColumnMoving",value:function(e){e.stopPropagation();var t=this.props,n=t.onResizedChange,r=t.column,o=this.getResolvedState(),a=o.resized,s=o.currentlyResizing,i=o.columns.find((function(e){return e.accessor===s.id||e.id===s.id})),l=i&&null!=i.minResizeWidth?i.minResizeWidth:r.minResizeWidth,c=a.filter((function(e){return e.id!==s.id})),u=void 0;"touchmove"===e.type?u=e.changedTouches[0].pageX:"mousemove"===e.type&&(u=e.pageX);var d=Math.max(s.parentWidth+u-s.startX,l);c.push({id:s.id,value:d}),this.setStateWithData({resized:c},(function(){return n&&n(c,e)}))}},{key:"resizeColumnEnd",value:function(e){e.stopPropagation();var t="touchend"===e.type||"touchcancel"===e.type;t&&(document.removeEventListener("touchmove",this.resizeColumnMoving),document.removeEventListener("touchcancel",this.resizeColumnEnd),document.removeEventListener("touchend",this.resizeColumnEnd)),document.removeEventListener("mousemove",this.resizeColumnMoving),document.removeEventListener("mouseup",this.resizeColumnEnd),document.removeEventListener("mouseleave",this.resizeColumnEnd),t||this.setStateWithData({skipNextSort:!0,currentlyResizing:!1})}}]),t}(X)));te.propTypes=Y,te.defaultProps=U;const ne=te;var re=d(7388);const oe=["#E24D42","#1F78C1","#BA43A9","#705DA0","#466803","#508642","#447EBC","#C15C17","#890F02","#757575","#0A437C","#6D1F62","#584477","#629E51","#2F4F4F","#BF1B00","#806EB7","#8a2eb8","#699e00","#000000","#3F6833","#2F575E","#99440A","#E0752D","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],ae=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"],se=/^https?:\/\/.+/,ie=({tag:e,datasource:t,highlight:n,onClick:r})=>{const o=(0,re.useStyles2)(le),a=function(e){const t=function(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t}(e.toLowerCase());return{color:oe[Math.abs(t%oe.length)],borderColor:ae[Math.abs(t%ae.length)]}}(e.tag),s={background:a.color,borderColor:a.borderColor},i=se.test(e.value);let l=f().createElement(f().Fragment,null,e.value?`${e.tag}: ${e.value}`:`${e.tag}`);return i&&(l=f().createElement(re.Tooltip,{placement:"top",content:e.value},f().createElement("a",{href:e.value,target:"_blank",rel:"noreferrer"},f().createElement(re.Icon,{name:"link",className:o.icon}),e.tag))),f().createElement("span",{className:"label label-tag zbx-tag "+(n?"highlighted":""),style:s,onClick:n=>{r&&r(e,t,n.ctrlKey,n.shiftKey)}},l)},le=e=>({icon:b.css`
    margin-right: ${e.spacing(.5)};
  `}),ce=({status:e,className:t})=>{const n=(0,b.cx)(t,"icon-gf",{"icon-gf-critical":"critical"===e||"problem"===e||"warning"===e},{"icon-gf-online":"online"===e||"ok"===e});return f().createElement("i",{className:n})},ue=({icon:e,customClass:t})=>{const n=(0,b.cx)(t,"fa-icon-container");return f().createElement("span",{className:n},f().createElement("i",{className:`fa fa-${e}`}))},de=ue,pe=({icon:e,width:t,tooltip:n,className:r,children:o,onClick:a})=>{const s=(0,re.useTheme)(),i=me(s),l=(0,b.cx)("btn",i.button,b.css`width: ${t||3}rem`,r);let c=f().createElement("button",{className:l,onClick:a},e&&f().createElement(ue,{icon:e,customClass:i.icon}),o);return n&&(c=f().createElement(re.Tooltip,{placement:"bottom",content:n},c)),c},me=(0,re.stylesFactory)((e=>{const t=e.type===o.GrafanaThemeType.Light?"#497dc0":"#005f81",n=e.type===o.GrafanaThemeType.Light?"#456ba4":"#354f77";return{button:b.css`
      height: 2rem;
      background-image: none;
      background-color: ${t};
      border: 1px solid ${e.palette.gray1};
      border-radius: 1px;
      color: ${e.colors.text};

      i {
        vertical-align: middle;
      }

      &:hover {
        background-color: ${n};
      }
    `,icon:b.css`
      i {
        color: ${e.colors.text};
      }
    `}})),he=({className:e,onClick:t})=>f().createElement(pe,{className:e,icon:"reply-all",tooltip:"Acknowledge problem",onClick:t}),ge=({problem:e,panelId:t,range:n})=>f().createElement(pe,{icon:"compass",width:6,onClick:()=>fe(e,t,n)},"Explore"),fe=(e,t,n)=>{var r,a;let s={};if(1===(null===(r=e.items)||void 0===r?void 0:r.length)&&1===(null===(a=e.hosts)||void 0===a?void 0:a.length)){const t=e.items[0],n=e.hosts[0],r=u(t.name,t.key_);s={queryType:"0",group:{filter:"/.*/"},application:{filter:""},host:{filter:n.name},item:{filter:r}}}else{var i;s={queryType:"3",itemids:null===(i=e.items)||void 0===i?void 0:i.map((e=>e.itemid)).join(",")}}const l={datasource:e.datasource,context:"explore",originPanelId:t,range:n.raw,queries:[s]},c=JSON.stringify(l),d=o.urlUtil.renderUrl("/explore",{left:c});v.locationService.push(d)},ve=({className:e,onClick:t})=>f().createElement(pe,{className:e,icon:"terminal",tooltip:"Execute script",onClick:t});var ye=d(2729),be=d.n(ye);function Ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ee(e,t,n[t])}))}return e}const Pe=f().createContext(v.config),Ce=Pe.Consumer,xe=({children:e})=>f().createElement(Ce,null,(t=>f().createElement(re.ThemeContext.Provider,{value:(0,o.createTheme)({colors:{mode:v.config.bootData.user.lightTheme?"light":"dark"}})},e)));class Se extends f().Component{renderModal(){const{component:e,props:t}=this.state;if(!e)return null;this.modalRoot.appendChild(this.modalNode);const n=f().createElement((e=>(e=>t=>f().createElement(Pe.Provider,{value:v.config},f().createElement(e,we({},t))))((t=>f().createElement(xe,null,f().createElement(e,we({},t))))))(e),t);return be().createPortal(n,this.modalNode)}render(){const{children:e}=this.props,t=e;return f().createElement(f().Fragment,null,f().createElement(t,{showModal:this.showModal,hideModal:this.hideModal}),this.renderModal())}constructor(e){super(e),this.modalRoot=document.body,this.modalNode=document.createElement("div"),this.showModal=(e,t)=>{this.setState({component:e,props:t})},this.hideModal=()=>{this.modalRoot.removeChild(this.modalNode),this.setState({component:null,props:{}})},this.state={component:null,props:{}}}}f().forwardRef((({data:e,isFocused:t,disabled:n,onClick:r,hideDescription:o},a)=>{const s=(0,re.useTheme2)(),i=(0,re.getSelectStyles)(s),l=(0,re.useStyles2)(Ne()),c=(0,b.cx)(i.option,l.menuOptionWrapper,t&&i.optionFocused,n&&l.menuOptionDisabled);return f().createElement("div",{ref:a,className:c,"aria-label":"Menu option",onClick:t=>{n||(t.preventDefault(),t.stopPropagation(),r(e))}},f().createElement("div",{className:(0,b.cx)(i.optionBody,l.menuOptionBody)},f().createElement("span",null,e.label||e.value),!o&&e.description&&f().createElement("div",{className:i.optionDescription},e.description)),e.description&&f().createElement(re.Tooltip,{content:e.description},f().createElement(re.Icon,{name:"info-circle",className:l.menuOptionInfoSign})))})).displayName="MenuOption";const Ne=e=>t=>({menuWrapper:b.css`
      display: flex;
      max-height: 650px;
      position: absolute;
      z-index: ${t.zIndex.dropdown};
      overflow: hidden;
      min-width: auto;
    `,menu:b.css`
      min-width: ${t.spacing(e||0)};

      & > div {
        padding-top: ${t.spacing(1)};
      }
    `,menuLeft:b.css`
      right: 0;
      flex-direction: row-reverse;
    `,container:b.css`
      padding: ${t.spacing(1)};
      border: 1px ${t.colors.border.weak} solid;
      border-radius: ${t.shape.borderRadius(1)};
      background-color: ${t.colors.background.primary};
      z-index: ${t.zIndex.modal};
    `,menuOptionWrapper:b.css`
      padding: ${t.spacing(.5)};
    `,menuOptionBody:b.css`
      font-weight: ${t.typography.fontWeightRegular};
      padding: ${t.spacing(0,1.5,0,0)};
    `,menuOptionDisabled:b.css`
      color: ${t.colors.text.disabled};
      cursor: not-allowed;
    `,menuOptionInfoSign:b.css`
      color: ${t.colors.text.disabled};
    `}),ke=[{value:0,label:"Not classified"},{value:1,label:"Information"},{value:2,label:"Warning"},{value:3,label:"Average"},{value:4,label:"High"},{value:5,label:"Disaster"}];class Te extends g.PureComponent{renderActions(){const{canClose:e}=this.props;return[f().createElement(re.Checkbox,{key:"ack",label:"Acknowledge",value:this.state.acknowledge,onChange:this.onAcknowledgeToggle}),f().createElement(re.Checkbox,{key:"change-severity",label:"Change severity",description:"",value:this.state.changeSeverity,onChange:this.onChangeSeverityToggle}),this.state.changeSeverity&&f().createElement(re.RadioButtonGroup,{key:"severity",size:"sm",options:ke,value:this.state.selectedSeverity,onChange:this.onChangeSelectedSeverity}),e&&f().createElement(re.Checkbox,{key:"close",label:"Close problem",disabled:!e,value:this.state.closeProblem,onChange:this.onCloseProblemToggle})].filter((e=>e))}render(){const{theme:e}=this.props,t=Oe(e),n=(0,b.cx)(t.modal),r=(0,b.cx)(t.modalHeaderTitle),o=(0,b.cx)("gf-form",t.inputGroup),a=(0,b.cx)(this.state.error&&t.input),s=(0,b.cx)("gf-form-hint-text",t.inputHint),i=(0,b.cx)("gf-form-hint-text",t.inputError);return f().createElement(re.Modal,{isOpen:!0,onDismiss:this.dismiss,className:n,title:f().createElement("div",{className:r},this.state.loading?f().createElement(re.Spinner,{size:18}):f().createElement(ue,{icon:"reply-all"}),f().createElement("span",{className:"p-l-1"},"Acknowledge Problem"))},f().createElement("div",{className:o},f().createElement("label",{className:"gf-form-hint"},f().createElement(re.TextArea,{className:a,type:"text",name:"message",placeholder:"Message",autoComplete:"off",autoFocus:!0,value:this.state.value,onChange:this.handleChange,onKeyDown:this.handleKeyPress}),f().createElement("small",{className:s},"Press Enter to submit"),this.state.error&&f().createElement("small",{className:i},this.state.errorMessage))),f().createElement("div",{className:"gf-form"},f().createElement(re.VerticalGroup,null,this.renderActions())),this.state.ackError&&f().createElement("div",{className:"gf-form ack-request-error"},f().createElement("span",{className:t.ackError},this.state.ackError)),f().createElement("div",{className:"gf-form-button-row text-center"},f().createElement(re.Button,{variant:"primary",onClick:this.submit},"Update"),f().createElement(re.Button,{variant:"secondary",onClick:this.dismiss},"Cancel")))}constructor(e){super(e),this.handleChange=e=>{this.setState({value:e.target.value,error:!1})},this.handleKeyPress=e=>{13===e.which||"Enter"===e.key||27!==e.which&&"Escape"!==e.key||this.dismiss()},this.handleBackdropClick=()=>{this.dismiss()},this.onAcknowledgeToggle=()=>{this.setState({acknowledge:!this.state.acknowledge,error:!1})},this.onChangeSeverityToggle=()=>{this.setState({changeSeverity:!this.state.changeSeverity,error:!1})},this.onCloseProblemToggle=()=>{this.setState({closeProblem:!this.state.closeProblem,error:!1})},this.onChangeSelectedSeverity=e=>{this.setState({selectedSeverity:e})},this.dismiss=()=>{this.setState({value:"",error:!1,errorMessage:"",ackError:"",loading:!1}),this.props.onDismiss()},this.submit=()=>{const{acknowledge:e,changeSeverity:t,closeProblem:n}=this.state,r=e||t||n;if(!this.state.value&&!r)return this.setState({error:!0,errorMessage:"Enter message text or select an action"});this.setState({ackError:"",loading:!0});const o={message:this.state.value};let a=4;this.state.acknowledge&&(a+=2),this.state.changeSeverity&&(a+=8,o.severity=this.state.selectedSeverity),this.state.closeProblem&&(a+=1),o.action=a,this.props.onSubmit(o).then((()=>{this.dismiss()})).catch((e=>{var t,n;const r=(null===(t=e.data)||void 0===t?void 0:t.message)||(null===(n=e.data)||void 0===n?void 0:n.error)||e.data||e.statusText||"";this.setState({ackError:r,loading:!1})}))},this.state={value:"",error:!1,errorMessage:"",ackError:"",acknowledge:!1,closeProblem:!1,changeSeverity:!1,selectedSeverity:e.severity||0,loading:!1}}}Te.defaultProps={withBackdrop:!0};const Oe=(0,re.stylesFactory)((e=>{const t=e.palette.red;return{modal:b.css`
      width: 500px;
    `,modalHeaderTitle:b.css`
      font-size: ${e.typography.heading.h3};
      padding-top: ${e.spacing.sm};
      margin: 0 ${e.spacing.md};
      display: flex;
    `,inputGroup:b.css`
      margin-bottom: 16px;
    `,input:b.css`
      border-color: ${t};
      border-radius: 2px;
      outline-offset: 2px;
      box-shadow: 0 0 0 2px ${e.colors.bg1}, 0 0 0px 4px ${t};
    `,inputHint:b.css`
      display: inherit;
      float: right;
      color: ${e.colors.textWeak};
    `,inputError:b.css`
      float: left;
      color: ${t};
    `,ackError:b.css`
      color: ${t};
    `}})),ze=(0,re.withTheme)(Te);function Fe(e){const{acknowledges:t}=e;return f().createElement("div",{className:"problem-ack-list"},f().createElement("div",{className:"problem-ack-col problem-ack-time"},t.map((e=>f().createElement("span",{key:e.acknowledgeid,className:"problem-ack-time"},e.time)))),f().createElement("div",{className:"problem-ack-col problem-ack-user"},t.map((e=>f().createElement("span",{key:e.acknowledgeid,className:"problem-ack-user"},function(e){return e.name||e.surname?`${e.name} ${e.surname}`.trim():e.user}(e))))),f().createElement("div",{className:"problem-ack-col problem-ack-message"},t.map((e=>f().createElement("span",{key:e.acknowledgeid,className:"problem-ack-message"},e.message)))))}function De(){return De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},De.apply(this,arguments)}const Re=Math.round(9.6);class Me extends g.PureComponent{componentDidUpdate(e,t){if(this.rootRef&&t.width!==this.rootRef.clientWidth){const e=this.rootRef.clientWidth;this.setState({width:e})}}getEventDuration(e,t){return 1e3*Math.abs(Number(this.sortedEvents[e].clock)-Number(this.sortedEvents[t].clock))}sortEvents(){const e=s().sortBy(this.props.events,(e=>Number(e.clock)));return this.sortedEvents=e,e}getEventAcks(e){const t=[];for(const n of e)if(n.acknowledges)for(const e of n.acknowledges)t.push(e);return s().sortBy(t,(e=>Number(e.clock)))}render(){if(!this.rootRef)return f().createElement("div",{className:"event-timeline",ref:this.setRootRef});const{timeRange:e,eventPointSize:t,eventRegionHeight:n}=this.props,r=this.sortEvents(),o=this.getEventAcks(r),a=this.state.width+t,s=Math.round(2.5*t),i=a-t,l=Math.round(t/2),c=n/2,u=Math.round(s/2-t/2);return f().createElement("div",{className:"event-timeline",ref:this.setRootRef,style:{transform:`translate(${-l}px, 0)`}},f().createElement(je,{className:"timeline-info-container",event:this.state.highlightedEvent,eventInfo:this.state.eventInfo,show:this.state.showEventInfo,left:l}),f().createElement("svg",{className:"event-timeline-canvas",viewBox:`0 0 ${a} ${s}`},f().createElement("defs",null,f().createElement(He,null)),f().createElement("g",{className:"event-timeline-group",transform:`translate(${l}, ${u})`},f().createElement("g",{className:"event-timeline-regions",filter:"url(#boxShadow)"},f().createElement(Ae,{events:r,timeRange:e,width:i,height:n,highlightedRegion:this.state.highlightedRegion})),f().createElement("g",{className:"timeline-acknowledges",transform:`translate(0, ${c})`},f().createElement(_e,{acknowledges:o,timeRange:e,width:i,size:t,onHighlight:this.handleAckHighlight,onUnHighlight:this.handleAckUnHighlight})),f().createElement("g",{className:"timeline-points",transform:`translate(0, ${c})`},f().createElement($e,{events:r,timeRange:e,width:i,pointSize:t,onPointHighlight:this.handlePointHighlight,onPointUnHighlight:this.handlePointUnHighlight})))))}constructor(e){super(e),this.setRootRef=e=>{this.rootRef=e;const t=e&&e.clientWidth||0;this.setState({width:t})},this.handlePointHighlight=(e,t)=>{const n=this.sortedEvents[e],r=this.getRegionToHighlight(e);let o;void 0!==t&&(o=this.getEventDuration(e,t)),this.setState({highlightedEvent:n,showEventInfo:!0,highlightedRegion:r,eventInfo:{duration:o}})},this.handlePointUnHighlight=()=>{this.setState({showEventInfo:!1,highlightedRegion:null})},this.handleAckHighlight=(e,t)=>{this.setState({showEventInfo:!0,eventInfo:{timestamp:Number(e.clock),message:e.message}})},this.handleAckUnHighlight=()=>{this.setState({showEventInfo:!1})},this.showEventInfo=e=>{this.setState({highlightedEvent:e,showEventInfo:!0})},this.hideEventInfo=()=>{this.setState({showEventInfo:!1})},this.getRegionToHighlight=e=>"1"===this.sortedEvents[e].value?e+1:e,this.state={width:0,highlightedEvent:null,highlightedRegion:null,showEventInfo:!1,eventInfo:{}}}}function He(){return f().createElement(f().Fragment,null,f().createElement("filter",{id:"dropShadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},f().createElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"2"}),f().createElement("feOffset",{dx:"1",dy:"1"}),f().createElement("feMerge",null,f().createElement("feMergeNode",null),f().createElement("feMergeNode",{in:"SourceGraphic"}))),f().createElement("filter",{id:"boxShadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},f().createElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"1"}),f().createElement("feComponentTransfer",null,f().createElement("feFuncA",{type:"linear",slope:"0.7"})),f().createElement("feOffset",{dx:"1",dy:"1"}),f().createElement("feMerge",null,f().createElement("feMergeNode",null),f().createElement("feMergeNode",{in:"SourceGraphic"}))),f().createElement("filter",{id:"glowShadow",x:"-50%",y:"-50%",width:"200%",height:"200%"},f().createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2"}),f().createElement("feMerge",null,f().createElement("feMergeNode",null),f().createElement("feMergeNode",{in:"SourceGraphic"}))),f().createElement("filter",{id:"timelinePointBlur",x:"-50%",y:"-50%",width:"200%",height:"200%"},f().createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blurOut"})))}Me.defaultProps={okColor:"rgb(56, 189, 113)",problemColor:"rgb(215, 0, 0)",eventRegionHeight:Re,eventPointSize:16};class je extends g.PureComponent{render(){const{event:e,eventInfo:t,show:n,className:r,left:o}=this.props;let a,s;if(e){const t=l()(1e3*Number(e.clock)).format("HH:mm:ss");a=[f().createElement("span",{key:"ts",className:"event-timestamp"},f().createElement("span",{className:"event-timestamp-label"},"Time: "),f().createElement("span",{className:"event-timestamp-value"},t))]}if(t&&t.duration){const e=t.duration,n=l().utc(e).format("HH:mm:ss");s=f().createElement("span",{key:"duration",className:"event-timestamp"},f().createElement("span",{className:"event-timestamp-label"},"Duration: "),f().createElement("span",{className:"event-timestamp-value"},n))}if(t&&t.timestamp){const e=l()(1e3*t.timestamp).format("HH:mm:ss");a=[f().createElement("span",{key:"ts",className:"event-timestamp"},f().createElement("span",{className:"event-timestamp-label"},"Time: "),f().createElement("span",{className:"event-timestamp-value"},e))]}const i={left:o};return n||(i.opacity=0),f().createElement("div",{className:r,style:i},f().createElement("div",null,a),f().createElement("div",null,s),t&&t.message&&f().createElement("div",null,f().createElement("span",{key:"duration",className:"event-timestamp"},f().createElement("span",{className:"event-timestamp-label"},"Message: "),f().createElement("span",{className:"event-timestamp-value"},t.message))))}}je.defaultProps={left:0,className:"",show:!1};class Ae extends g.PureComponent{render(){const{events:e,timeRange:t,width:n,height:r,highlightedRegion:o}=this.props,a=t.from.unix(),s=t.to.unix(),i=s-a;let l;if(e.length){const t=((e.length?Number(e[0].clock):s)-a)/i,c=Math.round(t*n),u=0===o,d=`problem-event-region ${"problem-event--"+("1"!==e[0].value?"problem":"ok")} ${u?"highlighted":""}`,p={x:0,y:0,width:c,height:r};l=f().createElement("rect",De({key:"0",className:d},p))}const c=e.map(((t,l)=>{const c=Number(t.clock),u=((l<e.length-1?Number(e[l+1].clock):s)-c)/i,d=Math.round(u*n),p=Math.round((c-a)/i*n),m=o&&o-1===l,h=`problem-event-region ${"problem-event--"+("1"===t.value?"problem":"ok")} ${m?"highlighted":""}`,g={x:p,y:0,width:d,height:r};return f().createElement("rect",De({key:`${t.eventid}-${l}`,className:h},g))}));return f().createElement(f().Fragment,null,l,c)}}Ae.defaultProps={highlightedRegion:null};class $e extends g.PureComponent{getRegionEvents(e){const t=this.props.events,n=t[e];if("1"===n.value&&e<t.length){for(let n=e;n<t.length;n++)if("0"===t[n].value)return[e,n]}else if("0"===n.value&&e>0){let n=null;for(let r=e-1;r>=0&&"1"===t[r].value;r--)n=r;if(null!==n)return[e,n]}return[e]}render(){const{events:e,timeRange:t,width:n,pointSize:r}=this.props,o=t.from.unix(),a=t.to.unix()-o,s=r/2,i=e.map(((e,t)=>{const r=Number(e.clock),i=Math.round((r-o)/a*n-s),l="problem-event-item problem-event--"+("1"===e.value?"problem":"ok"),c=-1!==this.state.highlighted.indexOf(t);return f().createElement(Be,{key:`${e.eventid}-${t}`,className:l,x:i,r:s,highlighted:c,onPointHighlight:this.highlightPoint(t),onPointUnHighlight:this.unHighlightPoint(t)})}));return this.state.order.length?this.state.order.map((e=>i[e])):i}constructor(e){super(e),this.bringToFront=(e,t=!1)=>{const{events:n}=this.props;let r=n.map(((e,t)=>t));r=We(r,e);const o=t?e:null;this.setState({order:r,highlighted:o})},this.highlightPoint=e=>()=>{let t=[e];if(this.props.onPointHighlight)if(this.props.highlightRegion){t=this.getRegionEvents(e);const n=2===t.length?t[1]:void 0;this.props.onPointHighlight(e,n)}else this.props.onPointHighlight(e);this.bringToFront(t,!0)},this.unHighlightPoint=e=>()=>{this.props.onPointUnHighlight&&this.props.onPointUnHighlight();const e=this.props.events.map(((e,t)=>t));this.setState({order:e,highlighted:[]})},this.state={order:[],highlighted:[]}}}$e.defaultProps={highlightRegion:!0};class Be extends g.PureComponent{componentDidUpdate(e){e.highlighted!==this.props.highlighted&&this.setState({highlighted:this.props.highlighted})}render(){const{x:e}=this.props,t=this.state.highlighted?Math.round(1.1*this.props.r):this.props.r,n=e+this.props.r,r=Math.round(.6*t),o=`${this.props.className||""} ${this.state.highlighted?"highlighted":""}`;return f().createElement("g",{className:o,transform:`translate(${n}, 0)`,filter:"url(#dropShadow)",onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave},f().createElement("circle",{cx:0,cy:0,r:t,className:"point-border"}),f().createElement("circle",{cx:0,cy:0,r,className:"point-core"}))}constructor(e){super(e),this.handleMouseOver=()=>{this.props.onPointHighlight&&this.props.onPointHighlight()},this.handleMouseLeave=()=>{this.props.onPointUnHighlight&&this.props.onPointUnHighlight()},this.state={highlighted:!1}}}class _e extends g.PureComponent{render(){const{acknowledges:e,timeRange:t,width:n,size:r}=this.props,o=t.from.unix(),a=t.to.unix()-o,s=r/2,i=e.map(((e,t)=>{const r=Number(e.clock),i=Math.round((r-o)/a*n-s),l=this.state.highlighted===t;return f().createElement(Ie,{key:`${e.eventid}-${t}`,x:i,r:s,highlighted:l,onHighlight:this.handleHighlight(t),onUnHighlight:this.handleUnHighlight})}));return this.state.order.length?this.state.order.map((e=>i[e])):i}constructor(e){super(e),this.handleHighlight=e=>()=>{if(this.props.onHighlight){const t=this.props.acknowledges[e];this.props.onHighlight(t,e)}this.bringToFront(e,!0)},this.handleUnHighlight=()=>{this.props.onUnHighlight&&this.props.onUnHighlight();const e=this.props.acknowledges.map(((e,t)=>t));this.setState({order:e,highlighted:null})},this.bringToFront=(e,t=!1)=>{const{acknowledges:n}=this.props;let r=n.map(((e,t)=>t));r=We(r,[e]);const o=t?e:null;this.setState({order:r,highlighted:o})},this.state={order:[],highlighted:null}}}class Ie extends g.PureComponent{componentDidUpdate(e){e.highlighted!==this.props.highlighted&&this.setState({highlighted:this.props.highlighted})}render(){const{x:e}=this.props,t=this.state.highlighted?Math.round(1.1*this.props.r):this.props.r,n=e+this.props.r,r=Math.round(.6*t),o="problem-event-ack "+(this.state.highlighted?"highlighted":"");return f().createElement("g",{className:o,transform:`translate(${n}, 0)`,filter:"url(#dropShadow)",onMouseOver:this.handleHighlight,onMouseLeave:this.handleUnHighlight},f().createElement("circle",{cx:0,cy:0,r:t,className:"point-border"}),f().createElement("circle",{cx:0,cy:0,r,className:"point-core"}))}constructor(e){super(e),this.handleHighlight=()=>{this.props.onHighlight&&this.props.onHighlight()},this.handleUnHighlight=()=>{this.props.onUnHighlight&&this.props.onUnHighlight()},this.state={highlighted:!1}}}function We(e,t){const n=s().pullAt(e,t);return n.reverse(),e.push(...n),e}function Le(e,t,n,r,o,a,s){try{var i=e[a](s),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}class Ke extends g.PureComponent{componentDidMount(){var e,t=this;return(e=function*(){const e=yield t.props.getScripts();t.scripts=e;const n=e.map((e=>({value:e.scriptid,label:e.name,description:e.description||e.command}))),r=(null==n?void 0:n.length)?n[0]:null,o=e.find((e=>r.value===e.scriptid));t.setState({scriptOptions:n,selectedScript:r,script:o})},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){Le(a,r,o,s,i,"next",e)}function i(e){Le(a,r,o,s,i,"throw",e)}s(void 0)}))})()}render(){const{theme:e}=this.props,{scriptOptions:t,selectedScript:n,script:r,result:o,selectError:a,errorMessage:s,error:i}=this.state,l=Ve(e),c=(0,b.cx)(l.modal),u=(0,b.cx)(l.modalHeaderTitle),d=(0,b.cx)("gf-form-hint-text",l.inputError),p=(0,b.cx)("gf-form",l.scriptCommandContainer),m=(0,b.cx)("gf-form-hint-text",l.scriptCommand);return f().createElement(re.Modal,{isOpen:!0,onDismiss:this.dismiss,className:c,title:f().createElement("div",{className:u},this.state.loading?f().createElement(re.Spinner,{size:18}):f().createElement(ue,{icon:"terminal"}),f().createElement("span",{className:"p-l-1"},"Execute script"))},f().createElement("div",{className:"gf-form"},f().createElement("label",{className:"gf-form-hint"},f().createElement(re.Select,{options:t,value:n,onChange:this.onChangeSelectedScript}),a&&f().createElement("small",{className:d},a))),f().createElement("div",{className:p},r&&f().createElement("small",{className:m},r.command)),f().createElement("div",{className:l.resultContainer},o&&f().createElement("span",{className:l.execResult},o),i&&f().createElement("span",{className:l.execError},s)),f().createElement("div",{className:"gf-form-button-row text-center"},f().createElement(re.Button,{variant:"primary",onClick:this.submit},"Execute"),f().createElement(re.Button,{variant:"secondary",onClick:this.dismiss},"Cancel")))}constructor(e){super(e),this.onChangeSelectedScript=e=>{const t=this.scripts.find((t=>e.value===t.scriptid));this.setState({selectedScript:e,script:t,errorMessage:"",loading:!1,result:""})},this.dismiss=()=>{this.setState({selectedScript:null,error:!1,errorMessage:"",selectError:"",loading:!1}),this.props.onDismiss()},this.submit=()=>{const{selectedScript:e}=this.state;if(!e)return this.setState({selectError:"Select a script to execute."});this.setState({errorMessage:"",loading:!0,result:""});const t={scriptid:e.value};this.props.onSubmit(t).then((e=>{const t=this.formatResult((null==e?void 0:e.value)||"");"success"===(null==e?void 0:e.response)?this.setState({result:t,loading:!1}):this.setState({error:!0,errorMessage:t,loading:!1})})).catch((e=>{var t,n;let r=(null===(t=e.data)||void 0===t?void 0:t.message)||(null===(n=e.data)||void 0===n?void 0:n.error)||e.data||e.statusText||"";r=this.formatResult(r),this.setState({error:!0,loading:!1,errorMessage:r})}))},this.formatResult=e=>{const t=e.split("\n").map(((e,t)=>f().createElement("p",{key:t},e)));return f().createElement(f().Fragment,null,t)},this.state={error:!1,errorMessage:"",selectError:"",selectedScript:null,result:"",loading:!1,scriptOptions:[],script:null}}}const Ve=(0,re.stylesFactory)((e=>{const t=e.palette.red;return{modal:b.css`
      width: 600px;
    `,modalHeaderTitle:b.css`
      font-size: ${e.typography.heading.h3};
      padding-top: ${e.spacing.sm};
      margin: 0 ${e.spacing.md};
      display: flex;
    `,input:b.css`
      border-color: ${t};
      border-radius: 2px;
      outline-offset: 2px;
      box-shadow: 0 0 0 2px ${e.colors.bg1}, 0 0 0px 4px ${t};
    `,scriptCommandContainer:b.css`
      margin-bottom: ${e.spacing.md};
    `,scriptCommand:b.css`
      color: ${e.colors.textWeak};
      text-align: left;
      font-family: ${e.typography.fontFamily.monospace};
    `,inputHint:b.css`
      display: inherit;
      float: right;
      color: ${e.colors.textWeak};
    `,inputError:b.css`
      float: left;
      color: ${t};
    `,resultContainer:b.css`
      min-height: 50px;
      font-family: ${e.typography.fontFamily.monospace};
      font-size: ${e.typography.size.sm};
      p {
        font-size: ${e.typography.size.sm};
        margin-bottom: 0px;
      }
    `,execResult:b.css``,execError:b.css`
      color: ${t};
    `}})),Ge=(0,re.withTheme)(Ke);function Ue(e){const{problem:t,alerts:n,className:r}=e,o="1"===t.type,a=t.url&&""!==t.url,s=t.maintenance,i="1"===t.manual_close,l=t.error&&""!==t.error,c="1"===t.state,u="1"===t.correlation_mode,d=n&&0!==n.length,p=d?n[0].message:"";return f().createElement("div",{className:`problem-statusbar ${r||""}`},f().createElement(qe,{icon:"wrench",fired:s,tooltip:"Host maintenance"}),f().createElement(qe,{icon:"globe",fired:a,link:a&&t.url,tooltip:"External link"}),f().createElement(qe,{icon:"bullhorn",fired:o,tooltip:"Trigger generates multiple problem events"}),f().createElement(qe,{icon:"tag",fired:u,tooltip:`OK event closes problems matched to tag: ${t.correlation_tag}`}),f().createElement(qe,{icon:"circle-o-notch",fired:d,tooltip:p}),f().createElement(qe,{icon:"question-circle",fired:c,tooltip:"Current trigger state is unknown"}),f().createElement(qe,{icon:"warning",fired:l,tooltip:t.error}),f().createElement(qe,{icon:"window-close-o",fired:i,tooltip:"Manual close problem"}))}function qe(e){const{fired:t,icon:n,link:r,tooltip:o}=e;let a=f().createElement("div",{className:"problem-statusbar-item "+(t?"fired":"muted")},f().createElement(de,{icon:n}));return o&&t&&(a=f().createElement(re.Tooltip,{placement:"bottom",content:o},a)),r?f().createElement("a",{href:r,target:"_blank",rel:"noreferrer"},a):a}const Je=({items:e})=>{const t=(0,re.useStyles2)(Xe);return f().createElement("div",{className:t.itemsRow},e.length>1?e.map((e=>f().createElement(Ye,{item:e,key:e.itemid,showName:!0}))):f().createElement(Ye,{item:e[0]}))},Ye=({item:e,showName:t})=>{const n=(0,re.useStyles2)(Xe),r=u(e.name,e.key_);return f().createElement("div",{className:n.itemContainer},f().createElement(ue,{icon:"thermometer-three-quarters"}),t&&f().createElement("span",{className:n.itemName},e.name,": "),f().createElement(re.Tooltip,{placement:"top-start",content:()=>f().createElement(f().Fragment,null,r,f().createElement("br",null),e.lastvalue)},f().createElement("span",null,e.lastvalue)))},Xe=e=>({itemContainer:b.css`
    display: flex;
  `,itemName:b.css`
    color: ${e.colors.text.secondary};
  `,itemsRow:b.css`
    overflow: hidden;
  `}),Qe=({hosts:e})=>{const t=(0,re.useStyles2)(et);return f().createElement(f().Fragment,null,e.map((e=>f().createElement("div",{className:t.hostContainer,key:e.hostid},f().createElement(ue,{icon:"server"}),f().createElement("span",null,e.name)))))},Ze=({hosts:e})=>{const t=(0,re.useStyles2)(et);return f().createElement(f().Fragment,null,f().createElement("span",{className:t.label},"Host description: "),e.map(((e,t)=>f().createElement("span",{key:`${e.hostid}-${t}`},e.description))))},et=e=>({hostContainer:b.css`
    margin-bottom: ${e.spacing(.2)};
  `,label:b.css`
    color: ${e.colors.text.secondary};
  `}),tt=({groups:e})=>{const t=(0,re.useStyles2)(nt);return f().createElement(f().Fragment,null,e.map((e=>f().createElement("div",{className:t.groupContainer,key:e.groupid},f().createElement(ue,{icon:"folder"}),f().createElement("span",null,e.name)))))},nt=e=>({groupContainer:b.css`
    margin-bottom: ${e.spacing(.2)};
  `}),rt=({problem:e})=>{const t=(0,re.useStyles2)(ot);return f().createElement(f().Fragment,null,f().createElement(re.Tooltip,{placement:"right",content:e.expression},f().createElement("span",{className:t.label},"Expression: ")),f().createElement("span",{className:t.expression},e.expression))},ot=e=>({label:b.css`
    color: ${e.colors.text.secondary};
  `,expression:b.css`
    font-family: ${e.typography.fontFamilyMonospace};
  `});function at(e,t,n,r,o,a,s){try{var i=e[a](s),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function st(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){at(a,r,o,s,i,"next",e)}function i(e){at(a,r,o,s,i,"throw",e)}s(void 0)}))}}const it=({original:e,rootWidth:t,timeRange:n,showTimeline:r,panelId:o,allowDangerousHTML:a,getProblemAlerts:s,getProblemEvents:i,getScripts:c,onExecuteScript:u,onProblemAck:d,onTagClick:p})=>{var m;const[h,y]=(0,g.useState)([]),[b,E]=(0,g.useState)([]),[w,P]=(0,g.useState)(!1);(0,g.useEffect)((()=>{r&&C(),S(),requestAnimationFrame((()=>{P(!0)}))}),[]);const C=(x=st((function*(){const t=e,n=yield i(t);y(n)})),function(){return x.apply(this,arguments)});var x;const S=function(){var t=st((function*(){const t=e,n=yield s(t);E(n)}));return function(){return t.apply(this,arguments)}}(),N=(e,t,n,r)=>{p&&p(e,t,n,r)},k=t=>d(e,t),T=()=>c(e),O=t=>u(e,t.scriptid),z=e,F=w?"show":"",D=t>1200,R=t<800||z.acknowledges&&D&&t<1400,M=l().unix(z.timestamp).fromNow(!0),H=z.acknowledges&&0!==z.acknowledges.length,j=Number(z.severity),A=(0,re.useStyles2)(lt);let $=e.datasource;(null===(m=e.datasource)||void 0===m?void 0:m.uid)&&($=(0,v.getDataSourceSrv)().getInstanceSettings(e.datasource.uid).name);const B=a?f().createElement("span",{dangerouslySetInnerHTML:{__html:z.comments}}):f().createElement("span",null,z.comments);return f().createElement("div",{className:`problem-details-container ${F}`},f().createElement("div",{className:"problem-details-body"},f().createElement("div",{className:A.problemDetails},f().createElement("div",{className:"problem-details-head"},f().createElement("div",{className:"problem-actions-left"},f().createElement(ge,{problem:z,panelId:o,range:n})),z.showAckButton&&f().createElement("div",{className:"problem-actions"},f().createElement(Se,null,(({showModal:e,hideModal:t})=>f().createElement(ve,{className:"problem-action-button",onClick:()=>{e(Ge,{getScripts:T,onSubmit:O,onDismiss:t})}}))),f().createElement(Se,null,(({showModal:e,hideModal:t})=>f().createElement(he,{className:"problem-action-button",onClick:()=>{e(ze,{canClose:"1"===z.manual_close,severity:j,onSubmit:k,onDismiss:t})}})))),f().createElement(Ue,{problem:z,alerts:b,className:R&&"compact"})),f().createElement("div",{className:"problem-details-row"},f().createElement("div",{className:"problem-value-container"},f().createElement("div",{className:"problem-age"},f().createElement(ue,{icon:"clock-o"}),f().createElement("span",null,M)),z.items&&f().createElement(Je,{items:z.items}))),z.comments&&f().createElement("div",{className:"problem-description-row"},f().createElement("div",{className:A.problemDescription},f().createElement(re.Tooltip,{placement:"right",content:B},f().createElement("span",{className:"description-label"},"Description: ")),B)),z.items&&f().createElement("div",null,f().createElement(rt,{problem:z})),z.hosts&&f().createElement("div",null,f().createElement(Ze,{hosts:z.hosts})),z.tags&&z.tags.length>0&&f().createElement("div",{className:"problem-tags"},z.tags&&z.tags.map((e=>f().createElement(ie,{key:e.tag+e.value,tag:e,datasource:z.datasource,highlight:e.tag===z.correlation_tag,onClick:N})))),r&&h.length>0&&f().createElement(Me,{events:h,timeRange:n}),H&&!D&&f().createElement("div",{className:"problem-ack-container"},f().createElement("h6",null,f().createElement(ue,{icon:"reply-all"})," Acknowledges"),f().createElement(Fe,{acknowledges:z.acknowledges}))),H&&D&&f().createElement("div",{className:"problem-details-middle"},f().createElement("div",{className:"problem-ack-container"},f().createElement("h6",null,f().createElement(ue,{icon:"reply-all"})," Acknowledges"),f().createElement(Fe,{acknowledges:z.acknowledges}))),f().createElement("div",{className:"problem-details-right"},f().createElement("div",{className:"problem-details-right-item"},f().createElement(ue,{icon:"database"}),f().createElement("span",null,$)),z.proxy&&f().createElement("div",{className:"problem-details-right-item"},f().createElement(ue,{icon:"cloud"}),f().createElement("span",null,z.proxy)),z.groups&&f().createElement(tt,{groups:z.groups}),z.hosts&&f().createElement(Qe,{hosts:z.hosts}))))},lt=e=>({problemDetails:b.css`
    position: relative;
    flex: 10 1 auto;
    // padding: 0.5rem 1rem 0.5rem 1.2rem;
    padding: ${e.spacing(.5)} ${e.spacing(1)} ${e.spacing(.5)} ${e.spacing(1.2)};
    display: flex;
    flex-direction: column;
    // white-space: pre-line;
    font-size: ${e.typography.bodySmall.fontSize};
  `,problemDescription:b.css`
    position: relative;
    max-height: 6rem;
    min-height: 3rem;
    overflow: hidden;

    &:after {
      content: '';
      text-align: right;
      position: inherit;
      bottom: 0;
      right: 0;
      width: 70%;
      height: 1.5rem;
      background: linear-gradient(to right, rgba(0, 0, 0, 0), ${e.colors.background.canvas} 50%);
    }
  `}),ct=(0,re.stylesFactory)((e=>({countLabel:b.css`
      font-size: ${e.typography.size.sm};
    `}))),ut=e=>{var t,n;const r=e.original,o=(0,re.useTheme)(),a=ct(o);return f().createElement("div",null,(null===(t=r.acknowledges)||void 0===t?void 0:t.length)>0&&f().createElement(f().Fragment,null,f().createElement(ue,{icon:"comments"}),f().createElement("span",{className:a.countLabel}," (",null===(n=r.acknowledges)||void 0===n?void 0:n.length,")")))};function dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pt(){return pt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pt.apply(this,arguments)}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){dt(e,t,n[t])}))}return e}class ht extends g.PureComponent{buildColumns(){const e=[],t=this.props.panelOptions,n=t.highlightNewEvents&&t.highlightNewerThan,r=[{Header:"Host",id:"host",show:t.hostField,Cell:e=>f().createElement(gt,{name:e.original.host,maintenance:e.original.hostInMaintenance})},{Header:"Host (Technical Name)",id:"hostTechName",show:t.hostTechNameField,Cell:e=>f().createElement(gt,{name:e.original.hostTechName,maintenance:e.original.hostInMaintenance})},{Header:"Host Groups",accessor:"groups",show:t.hostGroups,Cell:yt},{Header:"Proxy",accessor:"proxy",show:t.hostProxy},{Header:"Severity",show:t.severityField,className:"problem-severity",width:120,accessor:e=>e.priority,id:"severity",Cell:e=>function(e,t,n,r,o=ft){const a=e.original;let i,l;const c=Number(a.severity);return l=s().find(t,(e=>e.priority===c)),a.severity&&"1"===a.value&&(l=s().find(t,(e=>e.priority===c))),i="0"===a.value?o:l.color,n&&"1"===a.acknowledged&&(i=r),f().createElement("div",{className:"severity-cell",style:{background:i}},l.severity)}(e,t.triggerSeverity,t.markAckEvents,t.ackEventColor,t.okEventColor)},{Header:"",id:"statusIcon",show:t.statusIcon,className:"problem-status-icon",width:50,accessor:"value",Cell:e=>function(e,t){const n="0"===e.value?"ok":"problem";let r=!1;t&&(r=m(e.original,t));const o=(0,b.cx)("zbx-problem-status-icon",{"problem-status--new":r},{"zbx-problem":"1"===e.value},{"zbx-ok":"0"===e.value});return f().createElement(ce,{status:n,className:o})}(e,n)},{Header:"Status",accessor:"value",show:t.statusField,width:100,Cell:e=>function(e,t){const n="0"===e.value?"RESOLVED":"PROBLEM",r="0"===e.value?ft:vt;let o=!1;return t&&(o=m(e.original,t)),f().createElement("span",{className:o?"problem-status--new":"",style:{color:r}},n)}(e,n)},{Header:"Problem",accessor:"name",minWidth:200,Cell:bt},{Header:"Operational data",accessor:"opdata",show:t.opdataField,width:150,Cell:Et},{Header:"Ack",id:"ack",show:t.ackField,width:70,Cell:e=>f().createElement(ut,pt({},e))},{Header:"Tags",accessor:"tags",show:t.showTags,className:"problem-tags",Cell:e=>f().createElement(Pt,pt({},e,{onTagClick:this.handleTagClick}))},{Header:"Age",className:"problem-age",width:100,show:t.ageField,accessor:"timestamp",id:"age",Cell:wt},{Header:"Time",className:"last-change",width:150,accessor:"timestamp",id:"lastchange",Cell:e=>function(e,t){const n=e.original,r=t||"DD MMM YYYY HH:mm:ss",o=l().unix(n.timestamp).format(r);return f().createElement("span",null,o)}(e,t.customLastChangeFormat&&t.lastChangeFormat)},{Header:"",className:"custom-expander",width:60,expander:!0,Expander:Ct}];for(const t of r)(t.show||void 0===t.show)&&(delete t.show,e.push(t));return e}render(){const e=this.buildColumns();this.rootWidth=this.rootRef&&this.rootRef.clientWidth;const{pageSize:t,fontSize:n,panelOptions:r}=this.props,o=(0,b.cx)("panel-problems",{[`font-size--${n}`]:!!n});let a=[5,10,20,25,50,100];return t&&(a.push(t),a=s().uniq(s().sortBy(a))),f().createElement("div",{className:o,ref:this.setRootRef},f().createElement(ne,{data:this.props.problems,columns:e,defaultPageSize:10,pageSize:t,pageSizeOptions:a,resized:r.resizedColumns,minRows:0,loading:this.props.loading,noDataText:"No problems found",SubComponent:e=>f().createElement(it,pt({},e,{rootWidth:this.rootWidth,timeRange:this.props.timeRange,showTimeline:r.problemTimeline,allowDangerousHTML:r.allowDangerousHTML,panelId:this.props.panelId,getProblemEvents:this.props.getProblemEvents,getProblemAlerts:this.props.getProblemAlerts,getScripts:this.props.getScripts,onProblemAck:this.handleProblemAck,onExecuteScript:this.props.onExecuteScript,onTagClick:this.handleTagClick,subRows:!1})),expanded:this.getExpandedPage(this.state.page),onExpandedChange:this.handleExpandedChange,onPageChange:e=>this.setState({page:e}),onPageSizeChange:this.handlePageSizeChange,onResizedChange:this.handleResizedChange}))}constructor(e){super(e),this.setRootRef=e=>{this.rootRef=e},this.handleProblemAck=(e,t)=>this.props.onProblemAck(e,t),this.onExecuteScript=(e,t)=>{},this.handlePageSizeChange=(e,t)=>{this.props.onPageSizeChange&&this.props.onPageSizeChange(e,t)},this.handleResizedChange=(e,t)=>{this.props.onColumnResize&&this.props.onColumnResize(e)},this.handleExpandedChange=(e,t)=>{const{problems:n,pageSize:r}=this.props,{page:o}=this.state,a={};for(const t in e){const s=r*o+Number(t);if(e[t]&&s<n.length){const e=n[s].eventid;e&&(a[e]=!0)}}const s=mt({},this.state.expanded);s[o]=e;const i=mt({},this.state.expandedProblems);i[o]=a,this.setState({expanded:s,expandedProblems:i})},this.handleTagClick=(e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)},this.getExpandedPage=e=>{const{problems:t,pageSize:n}=this.props,{expandedProblems:r}=this.state,o=r[e]||{},a={},s=n*e,i=Math.min(s+n,t.length);for(let e=s;e<i;e++)o[t[e].eventid]&&(a[e-s]={});return a},this.rootWidth=0,this.state={expanded:{},expandedProblems:{},page:0}}}const gt=({name:e,maintenance:t})=>f().createElement("div",null,f().createElement("span",{style:{paddingRight:"0.4rem"}},e),t&&f().createElement(ue,{customClass:"fired",icon:"wrench"})),ft="rgb(56, 189, 113)",vt="rgb(215, 0, 0)";function yt(e){let t="";return e.value&&e.value.length&&(t=e.value.map((e=>e.name)).join(", ")),f().createElement("span",null,t)}function bt(e){return f().createElement("div",null,f().createElement("span",{className:"problem-description"},e.value))}function Et(e){const t=e.original;return f().createElement("div",null,f().createElement("span",null,t.opdata))}function wt(e){const t=e.original,n=l().unix(t.timestamp).fromNow(!0);return f().createElement("span",null,n)}class Pt extends g.PureComponent{render(){return[(this.props.value||[]).map((e=>f().createElement(ie,{key:e.tag+e.value,tag:e,datasource:this.props.original.datasource,onClick:this.handleTagClick})))]}constructor(...e){super(...e),this.handleTagClick=(e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)}}}function Ct(e){return f().createElement("span",{className:e.isExpanded?"expanded":""},f().createElement("i",{className:"fa fa-info-circle"}))}class xt extends g.PureComponent{render(){const{problem:e}=this.props,t=e.acknowledges&&e.acknowledges.map((e=>f().createElement("tr",{key:e.acknowledgeid},f().createElement("td",null,e.time),f().createElement("td",null,e.user),f().createElement("td",null,e.message))));return f().createElement("div",{className:"ack-tooltip"},f().createElement("table",{className:"table"},f().createElement("thead",null,f().createElement("tr",null,f().createElement("th",{className:"ack-time"},"Time"),f().createElement("th",{className:"ack-user"},"User"),f().createElement("th",{className:"ack-comments"},"Comments"))),f().createElement("tbody",null,t)),e.showAckButton&&f().createElement("div",{className:"ack-add-button"},f().createElement("button",{id:"add-acknowledge-btn",className:"btn btn-mini btn-inverse gf-form-button",onClick:this.handleClick},f().createElement("i",{className:"fa fa-plus"}))))}constructor(...e){super(...e),this.handleClick=e=>{this.props.onClick(e)}}}const St=({problem:e,color:t,blink:n,highlightBackground:r})=>{const o=Number(e.severity),a="1"===e.value&&o>=2?"critical":"online",s=(0,b.cx)("icon-gf",n&&"zabbix-trigger--blinked"),i=(0,b.cx)("alert-rule-item__icon",!r&&b.css`
        color: ${t};
      `);return f().createElement("div",{className:i},f().createElement(ce,{status:a,className:s}))};class Nt extends g.PureComponent{render(){var e;const{problem:t,panelOptions:n}=this.props,r=n.targets&&n.targets.length>1,a=(0,b.cx)("alert-rule-item","zbx-trigger-card",{"zbx-trigger-highlighted":n.highlightBackground}),i=(0,b.cx)("alert-rule-item__text",{"zbx-description--newline":n.descriptionAtNewLine}),c=Number(t.severity);let u;u=s().find(n.triggerSeverity,(e=>e.priority===c)),t.severity&&(u=s().find(n.triggerSeverity,(e=>e.priority===c)));const d=function(e,t){const n=new Date(e),r=t||"DD MMM YYYY HH:mm:ss";return o.dateMath.parse(n).format(r)}(t.timestamp,n.customLastChangeFormat&&n.lastChangeFormat),p=l().unix(t.timestamp).fromNow(!0);let h=t.datasource;if(null===(e=t.datasource)||void 0===e?void 0:e.uid){const e=(0,v.getDataSourceSrv)().getInstanceSettings(t.datasource.uid);h=e.name}let g=!1;n.highlightNewerThan&&(g=m(t,n.highlightNewerThan));const y=n.highlightNewEvents&&g;let E;E="0"===t.value?n.okEventColor:n.markAckEvents&&"1"===t.acknowledged?n.ackEventColor:u.color;const w={};return n.highlightBackground&&(w.backgroundColor=E),f().createElement("li",{className:a,style:w},f().createElement(St,{problem:t,color:E,highlightBackground:n.highlightBackground,blink:y}),f().createElement("div",{className:"alert-rule-item__body"},f().createElement("div",{className:"alert-rule-item__header"},f().createElement("div",{className:"alert-rule-item__name"},f().createElement("span",{className:"zabbix-trigger-name"},t.description),(n.hostField||n.hostTechNameField)&&f().createElement(kt,{problem:t,panelOptions:n}),n.hostGroups&&f().createElement(Tt,{problem:t,panelOptions:n}),n.showTags&&f().createElement("span",{className:"zbx-trigger-tags"},t.tags&&t.tags.map((e=>f().createElement(ie,{key:e.tag+e.value,tag:e,datasource:h,highlight:e.tag===t.correlation_tag,onClick:this.handleTagClick}))))),f().createElement("div",{className:i},n.statusField&&f().createElement(Ot,{problem:t,blink:y}),n.severityField&&f().createElement(zt,{severityDesc:u,blink:y,highlightBackground:n.highlightBackground}),f().createElement("span",{className:"alert-rule-item__time"},n.ageField&&"for "+p),n.descriptionField&&!n.descriptionAtNewLine&&f().createElement(f().Fragment,null,n.allowDangerousHTML?f().createElement("span",{className:"zbx-description",dangerouslySetInnerHTML:{__html:t.comments}}):f().createElement("span",{className:"zbx-description"},t.comments))),n.descriptionField&&n.descriptionAtNewLine&&f().createElement("div",{className:"alert-rule-item__text zbx-description--newline"},n.allowDangerousHTML?f().createElement("span",{className:"alert-rule-item__info zbx-description",dangerouslySetInnerHTML:{__html:t.comments}}):f().createElement("span",{className:"alert-rule-item__info zbx-description"},t.comments)))),r&&f().createElement("div",{className:"alert-rule-item__time zabbix-trigger-source"},f().createElement("span",null,f().createElement("i",{className:"fa fa-database"}),h)),f().createElement("div",{className:"alert-rule-item__time zbx-trigger-lastchange"},f().createElement("span",null,d||"last change unknown"),f().createElement("div",{className:"trigger-info-block zbx-status-icons"},t.url&&f().createElement("a",{href:t.url,target:"_blank",rel:"noreferrer"},f().createElement("i",{className:"fa fa-external-link"})),"1"===t.state&&f().createElement(re.Tooltip,{placement:"bottom",content:t.error},f().createElement("span",null,f().createElement("i",{className:"fa fa-question-circle"}))),t.eventid&&f().createElement(Se,null,(({showModal:e,hideModal:n})=>f().createElement(Ft,{problem:t,onClick:()=>{e(ze,{canClose:"1"===t.manual_close,severity:c,onSubmit:this.ackProblem,onDismiss:n})}}))))))}constructor(...e){super(...e),this.handleTagClick=(e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)},this.ackProblem=e=>{const t=this.props.problem;return this.props.onProblemAck(t,e)}}}function kt(e){const t=e.problem,n=e.panelOptions;let r="";return n.hostField&&n.hostTechNameField?r=`${t.host} (${t.hostTechName})`:(n.hostField||n.hostTechNameField)&&(r=n.hostField?t.host:t.hostTechName),n.hostProxy&&t.proxy&&(r=`${t.proxy}: ${r}`),f().createElement("span",{className:"zabbix-hostname"},t.maintenance&&f().createElement("i",{className:"fa fa-wrench zbx-maintenance-icon"}),r)}function Tt(e){const t=e.problem;let n="";return e.panelOptions.hostGroups&&(n+=`[ ${s().map(t.groups,"name").join(", ")} ]`),f().createElement("span",{className:"zabbix-hostname"},n)}function Ot(e){const{problem:t,okColor:n,problemColor:r,blink:o}=e,a="0"===t.value?"RESOLVED":"PROBLEM",s="0"===t.value?n||"rgb(56, 189, 113)":r||"rgb(215, 0, 0)",i=(0,b.cx)("zbx-trigger-state",{"alert-state-critical":"1"===t.value},{"alert-state-ok":"0"===t.value},{"zabbix-trigger--blinked":o});return f().createElement("span",{className:i,style:{color:s}},a)}function zt(e){const{severityDesc:t,highlightBackground:n,blink:r}=e,o=(0,b.cx)("zbx-trigger-severity",{"zabbix-trigger--blinked":r}),a={};return n||(a.color=t.color),f().createElement("span",{className:o,style:a},t.severity)}class Ft extends g.PureComponent{render(){const{problem:e}=this.props;let t=null;return e.acknowledges&&e.acknowledges.length?t=f().createElement(re.Tooltip,{placement:"auto",content:this.renderTooltipContent,interactive:!0},f().createElement("span",null,f().createElement("i",{className:"fa fa-comments"}))):e.showAckButton&&(t=f().createElement(re.Tooltip,{placement:"bottom",content:"Acknowledge problem"},f().createElement("span",{role:"button",onClick:this.handleClick},f().createElement("i",{className:"fa fa-comments-o"})))),t}constructor(...e){super(...e),this.handleClick=e=>{this.props.onClick(e)},this.renderTooltipContent=()=>f().createElement(xt,{problem:this.props.problem,onClick:this.handleClick})}}class Dt extends g.PureComponent{getCurrentProblems(e){const{pageSize:t,problems:n}=this.props,r=t*e,o=Math.min(t*(e+1),n.length);return this.props.problems.slice(r,o)}render(){const{problems:e,panelOptions:t}=this.props,n=this.getCurrentProblems(this.state.page);let r=parseInt(t.fontSize.slice(0,t.fontSize.length-1),10);r=r&&100!==r?r:null;const o=(0,b.cx)("alert-rule-list",{[`font-size--${r}`]:!!r});return f().createElement("div",{className:"triggers-panel-container",key:"alertListContainer"},f().createElement("section",{className:"card-section card-list-layout-list"},f().createElement("ol",{className:o},n.map(((e,n)=>{var r;return f().createElement(Nt,{key:`${e.triggerid}-${e.eventid}-${(null===(r=e.datasource)||void 0===r?void 0:r.uid)||e.datasource}-${n}`,problem:e,panelOptions:t,onTagClick:this.handleTagClick,onProblemAck:this.handleProblemAck})})))),f().createElement("div",{className:"triggers-panel-footer",key:"alertListFooter"},f().createElement(Rt,{itemsLength:e.length,pageSize:this.props.pageSize,pageIndex:this.state.page,onPageChange:this.handlePageChange})))}constructor(e){super(e),this.handlePageChange=e=>{const t=this.getCurrentProblems(e);this.setState({page:e,currentProblems:t})},this.handleTagClick=(e,t,n,r)=>{this.props.onTagClick&&this.props.onTagClick(e,t,n,r)},this.handleProblemAck=(e,t)=>this.props.onProblemAck(e,t),this.state={page:0,currentProblems:this.getCurrentProblems(0)}}}class Rt extends g.PureComponent{render(){const{itemsLength:e,pageIndex:t,pageSize:n}=this.props,r=Math.ceil(e/n);if(1===r)return f().createElement("ul",null);const o=Math.max(t-3,0),a=Math.min(r,o+9),s=[];for(let e=o;e<a;e++){const n=(0,b.cx)("triggers-panel-page-link","pointer",{active:e===t}),r=e+1,o=f().createElement("li",{key:r.toString()},f().createElement("a",{className:n,onClick:this.handlePageChange(e)},r));s.push(o)}return f().createElement("ul",null,s)}constructor(...e){super(...e),this.handlePageChange=e=>()=>{this.props.onPageChange(e)}}}function Mt(e,t,n,r,o,a,s){try{var i=e[a](s),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function Ht(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){Mt(a,r,o,s,i,"next",e)}function i(e){Mt(a,r,o,s,i,"throw",e)}s(void 0)}))}}function jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const At={schemaVersion:8,hostField:!0,hostTechNameField:!1,hostProxy:!1,hostGroups:!1,showTags:!0,statusField:!0,statusIcon:!1,severityField:!0,ackField:!0,ageField:!1,opdataField:!1,descriptionField:!0,descriptionAtNewLine:!1,sortProblems:"lastchange",limit:void 0,layout:"table",fontSize:"100%",pageSize:10,problemTimeline:!0,highlightBackground:!1,highlightNewEvents:!1,highlightNewerThan:"1h",customLastChangeFormat:!1,lastChangeFormat:"",resizedColumns:[],allowDangerousHTML:!1,triggerSeverity:[{priority:0,severity:"Not classified",color:"rgb(108, 108, 108)",show:!0},{priority:1,severity:"Information",color:"rgb(120, 158, 183)",show:!0},{priority:2,severity:"Warning",color:"rgb(175, 180, 36)",show:!0},{priority:3,severity:"Average",color:"rgb(255, 137, 30)",show:!0},{priority:4,severity:"High",color:"rgb(255, 101, 72)",show:!0},{priority:5,severity:"Disaster",color:"rgb(215, 0, 0)",show:!0}],okEventColor:"rgb(56, 189, 113)",ackEventColor:"rgb(56, 219, 156)",markAckEvents:!1},$t=({onChange:e})=>f().createElement(re.Button,{variant:"secondary",onClick:()=>e([])},"Reset columns");function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Bt(e,t,n[t])}))}return e}function It(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const Wt=({value:e,onChange:t})=>{const n=n=>{e.forEach(((t,r)=>{t.priority===n.priority&&(e[r]=n)})),t(e)};return f().createElement(f().Fragment,null,e.map(((e,t)=>f().createElement(Lt,{key:`${e.priority}-${t}`,value:e,onChange:e=>n(e)}))))},Lt=({value:e,onChange:t})=>f().createElement(re.VerticalGroup,null,f().createElement(re.InlineFieldRow,null,f().createElement(re.InlineField,{labelWidth:12},f().createElement(re.Input,{width:24,defaultValue:e.severity,onBlur:n=>{var r;const o=null==n||null===(r=n.currentTarget)||void 0===r?void 0:r.value;null!==o&&t(It(_t({},e),{severity:o}))}})),f().createElement(re.InlineLabel,{width:4},f().createElement(re.ColorPicker,{color:e.color,onChange:n=>t(It(_t({},e),{color:n}))})),f().createElement(re.InlineField,{label:"Show"},f().createElement(re.InlineSwitch,{value:e.show,onChange:()=>t(It(_t({},e),{show:!e.show}))}))));(0,v.loadPluginCss)({dark:"plugins/alexanderzobnin-zabbix-app/styles/dark.css",light:"plugins/alexanderzobnin-zabbix-app/styles/light.css"});const Kt=new o.PanelPlugin((e=>{const{data:t,options:n,timeRange:r,onOptionsChange:a}=e,{layout:i,showTriggers:l,triggerSeverity:u,sortProblems:d}=n,p=()=>{const e=[];if(!(null==t?void 0:t.series))return[];for(const n of t.series)try{const t=n.fields[0].values;t.toArray&&e.push(...t.toArray())}catch(e){return console.log(e),[]}let n=s().cloneDeep(e);return n=n.map((e=>g(e))),n=m(n),n=h(n),n},m=e=>{let t=s().cloneDeep(e);return"unacknowledged"===l?t=t.filter((e=>!(e.acknowledges&&e.acknowledges.length))):"acknowledged"===l&&(t=t.filter((e=>e.acknowledges&&e.acknowledges.length))),t=t.filter((e=>{const t=void 0!==e.severity?Number(e.severity):Number(e.priority);return u[t].show})),t},h=e=>("priority"===d?e=s().orderBy(e,["severity","timestamp","eventid"],["desc","desc","desc"]):"lastchange"===d&&(e=s().orderBy(e,["timestamp","severity","eventid"],["desc","desc","desc"])),e),g=e=>{const t=s().cloneDeep(e);if(t.hosts&&t.hosts.length){const e=t.hosts[0];t.host=e.name,t.hostTechName=e.host,e.proxy&&(t.proxy=e.proxy)}return t.tags&&0===t.tags.length&&(t.tags=void 0),t.comments&&n.allowDangerousHTML&&(t.comments=t.comments.replace("\n","<br>")),t.lastchangeUnix=Number(t.lastchange),t},b=e=>{if(!e)return[];const t=s().map(e.split(","),(e=>e.trim()));return s().map(t,(e=>{const t=e.split(":");return{tag:t[0].trim(),value:t[1].trim()}}))},E=e=>s().map(e,(e=>`${e.tag}:${e.value}`)).join(", "),w=(P=Ht((function*(e){const t=[e.triggerid],n=Math.ceil(o.dateMath.parse(r.from).unix()),a=Math.ceil(o.dateMath.parse(r.to).unix());return(yield(0,v.getDataSourceSrv)().get(e.datasource)).zabbix.getEvents(t,n,a,[0,1],100)})),function(e){return P.apply(this,arguments)});var P;const C=function(){var e=Ht((function*(e){if(!e.eventid)return Promise.resolve([]);const t=[e.eventid];return(yield(0,v.getDataSourceSrv)().get(e.datasource)).zabbix.getEventAlerts(t)}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Ht((function*(e){var t;const n=(null===(t=e.hosts)||void 0===t?void 0:t.length)?e.hosts[0].hostid:null;return(yield(0,v.getDataSourceSrv)().get(e.datasource)).zabbix.getScripts([n])}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Ht((function*(e,t){var n;const r=(null===(n=e.hosts)||void 0===n?void 0:n.length)?e.hosts[0].hostid:null;return(yield(0,v.getDataSourceSrv)().get(e.datasource)).zabbix.executeScript(r,t)}));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Ht((function*(e,t){const{message:n,action:r,severity:o}=t,a=e.eventid,s=y.contextSrv.user.name+" (Grafana): "+n,i=yield(0,v.getDataSourceSrv)().get(e.datasource),l=y.contextSrv.isEditor||y.contextSrv.isGrafanaAdmin;return i.disableReadOnlyUsersAck&&!l?{message:"You have no permissions to acknowledge events."}:a?i.zabbix.acknowledgeEvent(a,s,r,o):{message:"Trigger has no events. Nothing to acknowledge."}}));return function(t,n){return e.apply(this,arguments)}}(),k=e=>{var t,r;a((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){jt(e,t,n[t])}))}return e}({},n),r=null!=(r={resizedColumns:e})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t))},T=(n,r,o,a)=>{o||a?((n,r)=>{var o;const a=e=>e.tag===n.tag&&e.value===n.value,i=null===(o=t.request)||void 0===o?void 0:o.targets;let l=!1;for(const e of i){var u;if((null===(u=e.datasource)||void 0===u?void 0:u.uid)===(null==r?void 0:r.uid)||e.datasource===r){var d;const t=null===(d=e.tags)||void 0===d?void 0:d.filter;let n=b(t);s().remove(n,a),n=s().uniqWith(n,s().isEqual);const r=E(n);e.tags.filter=r,l=!0}}if(l){const t=new c(i);e.eventBus.publish(t)}})(n,r):((n,r)=>{var o;const a=null===(o=t.request)||void 0===o?void 0:o.targets;let i=!1;for(const e of a){var l;if((null===(l=e.datasource)||void 0===l?void 0:l.uid)===(null==r?void 0:r.uid)||e.datasource===r){var u;const t=null===(u=e.tags)||void 0===u?void 0:u.filter;let r=b(t);const o={tag:n.tag,value:n.value};r.push(o),r=s().uniqWith(r,s().isEqual);const a=E(r);e.tags.filter=a,i=!0}}if(i){const t=new c(a);e.eventBus.publish(t)}})(n,r)};return f().createElement(f().Fragment,null,"list"===i&&(()=>{const e=p(),t=parseInt(n.fontSize.slice(0,n.fontSize.length-1),10),r=t&&100!==t?t:void 0;return f().createElement(Dt,{problems:e,panelOptions:n,pageSize:n.pageSize,fontSize:r,onProblemAck:N,onTagClick:T})})(),"table"===i&&(()=>{const e=p(),t=parseInt(n.fontSize.slice(0,n.fontSize.length-1),10),o=t&&100!==t?t:void 0;return f().createElement(ht,{problems:e,panelOptions:n,pageSize:n.pageSize,fontSize:o,timeRange:r,getProblemEvents:w,getProblemAlerts:C,getScripts:x,onExecuteScript:S,onProblemAck:N,onColumnResize:k,onTagClick:T})})())})).setPanelChangeHandler(((e,t,n)=>{var r;return null!==(r=e.options)&&void 0!==r?r:{}})).setMigrationHandler((e=>{var t,n;let r=null!==(n=e.options)&&void 0!==n?n:{};var o;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){h(e,t,n[t])}))}return e}({},{layout:e.layout,hostField:e.hostField,hostTechNameField:e.hostTechNameField,hostGroups:e.hostGroups,hostProxy:e.hostProxy,showTags:e.showTags,statusField:e.statusField,statusIcon:e.statusIcon,severityField:e.severityField,ackField:e.ackField,ageField:e.ageField,descriptionField:e.descriptionField,descriptionAtNewLine:e.descriptionAtNewLine,hostsInMaintenance:e.hostsInMaintenance,showTriggers:e.showTriggers,sortProblems:e.sortProblems,limit:e.limit,fontSize:e.fontSize,pageSize:e.pageSize,problemTimeline:e.problemTimeline,highlightBackground:e.highlightBackground,highlightNewEvents:e.highlightNewEvents,highlightNewerThan:e.highlightNewerThan,customLastChangeFormat:e.customLastChangeFormat,lastChangeFormat:e.lastChangeFormat,resizedColumns:e.resizedColumns,triggerSeverity:e.triggerSeverity,okEventColor:e.okEventColor,ackEventColor:e.ackEventColor,markAckEvents:e.markAckEvents,showEvents:null!==(o=null===(t=e.showEvents)||void 0===t?void 0:t.value)&&void 0!==o?o:e.showEvents},r)})).setPanelOptions((e=>{e.addSelect({path:"layout",name:"Layout",defaultValue:At.layout,settings:{options:[{label:"Table",value:"table"},{label:"List",value:"list"}]}}).addSelect({path:"sortProblems",name:"Sort by",defaultValue:At.sortProblems,settings:{options:[{label:"Default",value:"default"},{label:"Last change",value:"lastchange"},{label:"Severity",value:"priority"}]}}).addSelect({path:"fontSize",name:"Font size",defaultValue:At.fontSize,settings:{options:Vt}}).addNumberInput({path:"pageSize",name:"Page size",defaultValue:At.pageSize}).addBooleanSwitch({path:"problemTimeline",name:"Problem timeline",defaultValue:At.problemTimeline,showIf:e=>"table"===e.layout}).addBooleanSwitch({path:"highlightBackground",name:"Highlight background",defaultValue:At.highlightBackground,showIf:e=>"list"===e.layout}).addBooleanSwitch({path:"highlightNewEvents",name:"Highlight new events",defaultValue:At.highlightNewEvents}).addTextInput({path:"highlightNewerThan",name:"Newer than",defaultValue:At.highlightNewerThan,showIf:e=>e.highlightNewEvents}).addBooleanSwitch({path:"customLastChangeFormat",name:"Custom last change format",defaultValue:At.customLastChangeFormat}).addTextInput({path:"lastChangeFormat",name:"Last change format",defaultValue:At.lastChangeFormat,description:"See moment.js dosc for time format http://momentjs.com/docs/#/displaying/format/",settings:{placeholder:"dddd, MMMM Do YYYY, h:mm:ss a"},showIf:e=>e.customLastChangeFormat}).addBooleanSwitch({path:"allowDangerousHTML",name:"Allow HTML",description:"Format problem description and other data as HTML. Use with caution, it's potential cross-site scripting (XSS) vulnerability.",defaultValue:At.allowDangerousHTML}).addCustomEditor({id:"resetColumns",path:"resizedColumns",name:"Reset resized columns",editor:$t,showIf:e=>"table"===e.layout}).addCustomEditor({id:"triggerColors",path:"triggerSeverity",name:"Problem colors",editor:Wt,defaultValue:At.triggerSeverity,category:["Colors"]}).addBooleanSwitch({path:"markAckEvents",name:"Mark acknowledged events",defaultValue:At.markAckEvents,category:["Colors"]}).addColorPicker({path:"ackEventColor",name:"Acknowledged color",defaultValue:At.ackEventColor,showIf:e=>e.markAckEvents,settings:[{enableNamedColors:!1}],category:["Colors"]}).addColorPicker({path:"okEventColor",name:"OK event color",defaultValue:At.okEventColor,settings:[{enableNamedColors:!1}],category:["Colors"]}).addBooleanSwitch({path:"hostField",name:"Host name",defaultValue:At.hostField,category:["Fields"]}).addBooleanSwitch({path:"hostTechNameField",name:"Technical name",defaultValue:At.hostTechNameField,category:["Fields"]}).addBooleanSwitch({path:"hostGroups",name:"Host groups",defaultValue:At.hostGroups,category:["Fields"]}).addBooleanSwitch({path:"hostProxy",name:"Host proxy",defaultValue:At.hostProxy,category:["Fields"]}).addBooleanSwitch({path:"showTags",name:"Tags",defaultValue:At.showTags,category:["Fields"]}).addBooleanSwitch({path:"statusField",name:"Status",defaultValue:At.statusField,category:["Fields"]}).addBooleanSwitch({path:"statusIcon",name:"Status icon",defaultValue:At.statusIcon,category:["Fields"]}).addBooleanSwitch({path:"severityField",name:"Severity",defaultValue:At.severityField,category:["Fields"]}).addBooleanSwitch({path:"ackField",name:"Ack",defaultValue:At.ackField,category:["Fields"]}).addBooleanSwitch({path:"ageField",name:"Age",defaultValue:At.ageField,category:["Fields"]}).addBooleanSwitch({path:"opdataField",name:"Operational data",defaultValue:At.opdataField,category:["Fields"]}).addBooleanSwitch({path:"descriptionField",name:"Description",defaultValue:At.descriptionField,showIf:e=>"list"===e.layout,category:["Fields"]}).addBooleanSwitch({path:"descriptionAtNewLine",name:"At the new line",defaultValue:At.descriptionAtNewLine,showIf:e=>"list"===e.layout,category:["Fields"]})})),Vt=[{label:"80%",value:"80%"},{label:"90%",value:"90%"},{label:"100%",value:"100%"},{label:"110%",value:"110%"},{label:"120%",value:"120%"},{label:"130%",value:"130%"},{label:"150%",value:"150%"},{label:"160%",value:"160%"},{label:"180%",value:"180%"},{label:"200%",value:"200%"},{label:"220%",value:"220%"},{label:"250%",value:"250%"}]})(),p})()));
//# sourceMappingURL=module.js.map